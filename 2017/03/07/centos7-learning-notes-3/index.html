<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="google84e34793b41f97d4">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" integrity="sha256-jTIdiMuX/e3DGJUGwl3pKSxuc6YOuqtJYkM0bGQESA4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"haokaiyang.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.10.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="《鸟哥的Linux私房菜》硬盘与文件系统管理学习笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="《鸟哥的Linux私房菜》硬盘与文件系统管理学习笔记">
<meta property="og:url" content="http://haokaiyang.com/2017/03/07/centos7-learning-notes-3/index.html">
<meta property="og:site_name" content="郝凯阳">
<meta property="og:description" content="《鸟哥的Linux私房菜》硬盘与文件系统管理学习笔记">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2017-03-07T13:30:00.000Z">
<meta property="article:modified_time" content="2022-07-11T13:13:29.715Z">
<meta property="article:author" content="郝凯阳">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="学习笔记">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://haokaiyang.com/2017/03/07/centos7-learning-notes-3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://haokaiyang.com/2017/03/07/centos7-learning-notes-3/","path":"2017/03/07/centos7-learning-notes-3/","title":"《鸟哥的Linux私房菜》硬盘与文件系统管理学习笔记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>《鸟哥的Linux私房菜》硬盘与文件系统管理学习笔记 | 郝凯阳</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-106549978-1"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-106549978-1","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="郝凯阳" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">郝凯阳</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%B5%84%E6%96%99%E5%AD%98%E5%8F%96%E6%96%B9%E5%BC%8F"><span class="nav-number">1.</span> <span class="nav-text">索引式文件系统的资料存取方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux%E7%9A%84EXT2%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">2.</span> <span class="nav-text">Linux的EXT2文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#data-block"><span class="nav-number">2.1.</span> <span class="nav-text">data block</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inode-table"><span class="nav-number">2.2.</span> <span class="nav-text">inode table</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#superblock"><span class="nav-number">2.3.</span> <span class="nav-text">superblock</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Filesystem-Description"><span class="nav-number">2.4.</span> <span class="nav-text">Filesystem Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#block-bitmap"><span class="nav-number">2.5.</span> <span class="nav-text">block bitmap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inode-bitmap"><span class="nav-number">2.6.</span> <span class="nav-text">inode bitmap</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dumpe2fs-%E6%9F%A5%E8%A9%A2-Ext-%E5%AE%B6%E6%97%8F-superblock-%E4%BF%A1%E6%81%AF"><span class="nav-number">3.</span> <span class="nav-text">dumpe2fs:查詢 Ext 家族 superblock 信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8E%E7%9B%AE%E5%BD%95%E6%A0%91%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-number">4.</span> <span class="nav-text">与目录树的关系</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6"><span class="nav-number">4.1.</span> <span class="nav-text">文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E6%A0%91%E8%AF%BB%E5%8F%96"><span class="nav-number">4.2.</span> <span class="nav-text">目录树读取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%93%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E6%97%B6%E5%80%99-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%A1%8C%E4%B8%BA%E6%98%AF"><span class="nav-number">4.3.</span> <span class="nav-text">当新建一个文件时候,文件系统的行为是</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%BF%90%E4%BD%9C"><span class="nav-number">5.</span> <span class="nav-text">Linux文件系统的运作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mount-point%E7%9A%84%E6%84%8F%E4%B9%89"><span class="nav-number">5.1.</span> <span class="nav-text">mount point的意义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%A7%84%E5%88%92"><span class="nav-number">5.2.</span> <span class="nav-text">xfs文件系统的规划</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B5%84%E6%96%99%E5%8C%BA-data-section"><span class="nav-number">5.2.1.</span> <span class="nav-text">资料区(data section)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%A3%E6%A1%88%E7%B3%BB%E7%BB%9F%E6%B4%BB%E5%8A%A8%E7%99%BB%E5%BD%95%E5%8C%BA-log-section"><span class="nav-number">5.2.2.</span> <span class="nav-text">档案系统活动登录区(log section)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%B3%E6%97%B6%E8%BF%90%E4%BD%9C%E5%8C%BA-realtime-section"><span class="nav-number">5.2.3.</span> <span class="nav-text">即时运作区(realtime section)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%8F%8F%E8%BF%B0%E4%BF%A1%E6%81%AF"><span class="nav-number">5.3.</span> <span class="nav-text">xfs文件系统的描述信息</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-number">6.</span> <span class="nav-text">文件系统的操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AC%E7%9B%98%E4%B8%8E%E7%9B%AE%E5%BD%95%E5%AE%B9%E9%87%8F"><span class="nav-number">6.1.</span> <span class="nav-text">硬盘与目录容量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AC%E9%93%BE%E6%8E%A5%E4%B8%8E%E8%BD%AF%E9%93%BE%E6%8E%A5"><span class="nav-number">6.2.</span> <span class="nav-text">硬链接与软链接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A1%AC%E7%9B%98%E7%9A%84%E5%88%86%E5%89%B2%E3%80%81%E6%A0%BC%E5%BC%8F%E5%8C%96%E3%80%81%E6%A3%80%E9%AA%8C%E4%B8%8E%E6%8C%82%E8%BD%BD"><span class="nav-number">7.</span> <span class="nav-text">硬盘的分割、格式化、检验与挂载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%82%E5%AF%9F%E7%A1%AC%E7%9B%98%E5%88%86%E5%89%B2%E7%8A%B6%E6%80%81"><span class="nav-number">7.1.</span> <span class="nav-text">观察硬盘分割状态</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#lsblk%E5%88%97%E5%87%BA%E7%B3%BB%E7%BB%9F%E4%B8%8A%E6%89%80%E6%9C%89%E7%9A%84%E7%A1%AC%E7%9B%98%E5%88%97%E8%A1%A8-list-block-device"><span class="nav-number">7.1.1.</span> <span class="nav-text">lsblk列出系统上所有的硬盘列表( list block device)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#blkid%E5%88%97%E5%87%BA%E8%A3%85%E7%BD%AE%E7%9A%84UUID%E7%AD%89%E5%8F%82%E6%95%B0"><span class="nav-number">7.1.2.</span> <span class="nav-text">blkid列出装置的UUID等参数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AC%E7%9B%98%E5%88%86%E5%89%B2"><span class="nav-number">7.2.</span> <span class="nav-text">硬盘分割</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A1%AC%E7%9B%98%E5%88%86%E5%89%B2%E8%A1%A8%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%88%86%E5%89%B2%E5%92%A8%E8%AE%AF"><span class="nav-number">7.2.1.</span> <span class="nav-text">查看硬盘分割表类型与分割咨讯</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AC%E7%9B%98%E6%A0%BC%E5%BC%8F%E5%8C%96-%E5%BB%BA%E7%AB%8B%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">7.3.</span> <span class="nav-text">硬盘格式化(建立文件系统)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#xfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9Fmkfs-xfs"><span class="nav-number">7.3.1.</span> <span class="nav-text">xfs文件系统mkfs.xfs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9Ffor-RAID%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="nav-number">7.3.2.</span> <span class="nav-text">xfs文件系统for RAID性能优化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ext4%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9Fmkfs-ext4"><span class="nav-number">7.3.3.</span> <span class="nav-text">ext4文件系统mkfs.ext4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9Fmkfs"><span class="nav-number">7.3.4.</span> <span class="nav-text">其他文件系统mkfs</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%A3%80%E9%AA%8C"><span class="nav-number">7.4.</span> <span class="nav-text">文件系统检验</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#xfs-repair%E5%A4%84%E7%90%86XFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">7.4.1.</span> <span class="nav-text">xfs_repair处理XFS文件系统</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fsck-ext4-%E5%A4%84%E7%90%86EXT4%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">7.4.2.</span> <span class="nav-text">fsck.ext4 处理EXT4文件系统</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%8C%82%E8%BD%BD"><span class="nav-number">7.5.</span> <span class="nav-text">文件系统的挂载</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%82%E8%BD%BDxfs-x2F-ext4-x2F-vfat%E7%AD%89%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">7.5.1.</span> <span class="nav-text">挂载xfs&#x2F;ext4&#x2F;vfat等文件系统</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%82%E8%BD%BD%E5%85%89%E7%9B%98"><span class="nav-number">7.5.2.</span> <span class="nav-text">挂载光盘</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%82%E8%BD%BDvfatU%E7%9B%98"><span class="nav-number">7.5.3.</span> <span class="nav-text">挂载vfatU盘</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%87%8D%E6%96%B0%E6%8C%82%E8%BD%BD%E6%A0%B9%E7%9B%AE%E5%BD%95"><span class="nav-number">7.5.4.</span> <span class="nav-text">重新挂载根目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%82%E8%BD%BD%E4%B8%8D%E7%89%B9%E5%AE%9A%E7%9B%AE%E5%BD%95"><span class="nav-number">7.5.5.</span> <span class="nav-text">挂载不特定目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#umount-%E5%8D%B8%E8%BD%BD%E8%A3%85%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">7.5.6.</span> <span class="nav-text">umount(卸载装置文件)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AC%E7%9B%98-x2F-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%8F%82%E6%95%B0%E4%BF%AE%E6%94%B9"><span class="nav-number">7.6.</span> <span class="nav-text">硬盘&#x2F;文件系统参数修改</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#mknod"><span class="nav-number">7.6.1.</span> <span class="nav-text">mknod</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xfs-admin-%E4%BF%AE%E6%94%B9xfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84UUID%E4%B8%8ELabel-name"><span class="nav-number">7.6.2.</span> <span class="nav-text">xfs_admin 修改xfs文件系统的UUID与Label name</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tune2fs-%E4%BF%AE%E6%94%B9ext4%E7%9A%84label-name-%E4%B8%8EUUID"><span class="nav-number">7.6.3.</span> <span class="nav-text">tune2fs 修改ext4的label name 与UUID</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E6%9C%BA%E6%8C%82%E8%BD%BD"><span class="nav-number">8.</span> <span class="nav-text">开机挂载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E8%A3%85%E7%BD%AEloop%E6%8C%82%E8%BD%BD-%E4%B8%8D%E7%83%A7%E5%BD%95%E5%B0%B1%E6%8C%82%E8%BD%BD%E4%BD%BF%E7%94%A8"><span class="nav-number">8.1.</span> <span class="nav-text">特殊装置loop挂载(不烧录就挂载使用)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#swap%E5%BB%BA%E7%AB%8B"><span class="nav-number">9.</span> <span class="nav-text">swap建立</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%AE%9E%E4%BD%93%E5%88%86%E5%89%B2%E6%A7%BD%E5%BB%BA%E7%BD%AEswap"><span class="nav-number">9.1.</span> <span class="nav-text">使用实体分割槽建置swap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%96%87%E4%BB%B6%E5%BB%BA%E7%BD%AEswap"><span class="nav-number">9.2.</span> <span class="nav-text">使用文件建置swap</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%89%B9%E6%AE%8A%E8%A7%82%E5%AF%9F%E4%B8%8E%E6%93%8D%E4%BD%9C"><span class="nav-number">10.</span> <span class="nav-text">文件系统的特殊观察与操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AC%E7%9B%98%E7%A9%BA%E9%97%B4%E7%9A%84%E6%B5%AA%E8%B4%B9%E9%97%AE%E9%A2%98"><span class="nav-number">10.1.</span> <span class="nav-text">硬盘空间的浪费问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A9%E7%94%A8GNU%E7%9A%84parted%E8%BF%9B%E8%A1%8C%E5%88%86%E5%89%B2%E8%A1%8C%E4%B8%BA"><span class="nav-number">10.2.</span> <span class="nav-text">利用GNU的parted进行分割行为</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%9C%AC%E6%9C%BA%E5%88%86%E5%89%B2%E8%A1%A8%E8%B5%84%E6%96%99"><span class="nav-number">10.2.1.</span> <span class="nav-text">查看本机分割表资料</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="郝凯阳"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">郝凯阳</p>
  <div class="site-description" itemprop="description">Enjoy coding,Enjoy life:)</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://t.me/haokaiyang" title="Telegram → https:&#x2F;&#x2F;t.me&#x2F;haokaiyang" rel="noopener" target="_blank"><i class="telegram fa-fw"></i>Telegram</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/haokaiyang" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;haokaiyang" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://weibo.com/5146817200" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;5146817200" rel="noopener" target="_blank"><i class="weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://haokaiyang.com/2017/03/07/centos7-learning-notes-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="郝凯阳">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郝凯阳">
      <meta itemprop="description" content="Enjoy coding,Enjoy life:)">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="《鸟哥的Linux私房菜》硬盘与文件系统管理学习笔记 | 郝凯阳">
      <meta itemprop="description" content="《鸟哥的Linux私房菜》硬盘与文件系统管理学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          《鸟哥的Linux私房菜》硬盘与文件系统管理学习笔记
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2017-03-07 21:30:00" itemprop="dateCreated datePublished" datetime="2017-03-07T21:30:00+08:00">2017-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-11 21:13:29" itemprop="dateModified" datetime="2022-07-11T21:13:29+08:00">2022-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>48k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>44 分钟</span>
    </span>
</div>

            <div class="post-description">《鸟哥的Linux私房菜》硬盘与文件系统管理学习笔记</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="索引式文件系统的资料存取方式"><a href="#索引式文件系统的资料存取方式" class="headerlink" title="索引式文件系统的资料存取方式"></a>索引式文件系统的资料存取方式</h2><p>文件系统通常会将文件权限与文件属性(拥有者、群组、时间参数等)放置在inode中,实际资料则放置在data block区块中,还有一个超级区块(superblock)记录整个文件系统的信息,包括inode与block的总量、使用量、剩余量等。</p>
<ul>
<li>superblock:记录此filesystem的整体资讯,包括inode&#x2F;block的总量、使用量、剩余量以及文件系统的格式与相关资讯等。</li>
<li>inode:记录文件的的属性,一个文件占用一个inode,同时记录此文件的资料所在的block号码</li>
<li>block:实际记录文件的内容,若文件太大,会占用多个block</li>
</ul>
<h2 id="Linux的EXT2文件系统"><a href="#Linux的EXT2文件系统" class="headerlink" title="Linux的EXT2文件系统"></a>Linux的EXT2文件系统</h2><p>文件系统一开始就将inode与block规划好了,除非重新格式化或者使用resize2fs变更文件系统大小。<br>Ext2文件系统在格式化的时候基本分为多个区块群组,每个区块群组都有独立的inode&#x2F;block&#x2F;superblock系统。<br>每个区块群组分为六个主要内容:</p>
<h3 id="data-block"><a href="#data-block" class="headerlink" title="data block"></a>data block</h3><p>防止文件内容资料,在ext2文件系统中支持的block大小有1K,2K,4K三种,在格式化时候block的大小就固定了,且每个block都有编号,方便inode记录。<br>Ext2文件系统的block的限制:</p>
<ul>
<li>block的大小与数量格式化后就不能够再改变了</li>
<li>每个block最多只能放置一个文件的资料</li>
<li>如果文件大于block的大小,则一个文件会占用多个block数量</li>
<li>若文件小于block,则改block的剩余容量就不能再被使用了</li>
</ul>
<h3 id="inode-table"><a href="#inode-table" class="headerlink" title="inode table"></a>inode table</h3><p>inode 记录的文件资料:</p>
<ul>
<li>该文件的存取模式(read&#x2F;write&#x2F;excute)</li>
<li>文件拥有者与群组(owner&#x2F;group)</li>
<li>文件的容量</li>
<li>文件建立和状态变更的时间(ctime)</li>
<li>最近一次的读取时间(atime)</li>
<li>最近修改的时间(mtime)</li>
<li>文件特性的旗标(flag),如SUID…</li>
<li>文件真正内容的指向</li>
</ul>
<p>inode的特性:</p>
<ul>
<li>inode的数量与大小在格式化时就已经固定了</li>
<li>每个文件都有占用一个inode</li>
<li>文件系统能够建立的文件数量与inode数量有关</li>
<li>系统读取档案时需要先找到inode,并分析inode所记录的权限与使用者是否符合,符合才可以读取block的内容</li>
</ul>
<h3 id="superblock"><a href="#superblock" class="headerlink" title="superblock"></a>superblock</h3><p>super记录的信息有:</p>
<ul>
<li>block与inode的数量</li>
<li>未使用与已使用的block和inode数量</li>
<li>block与inode的大小(block 1K,2K,4K.inode为128bytes或256bytes)</li>
<li>filesystem的挂载时间、最近一次写入资料的时间、最近一次检验磁盘(fsck)的时间等文件系统的相关信息</li>
<li>一个valid bit数量,valid bit为1表示文件系统未被挂载,valid bit为0表示已经挂载<br>一般来说superblock的大小为1024bytes</li>
</ul>
<h3 id="Filesystem-Description"><a href="#Filesystem-Description" class="headerlink" title="Filesystem Description"></a>Filesystem Description</h3><p>描述每个block group的开始与结束的block号码,以及每个区块(superblock,bitmap,inodemap,data block)分别介于哪一个block之间。</p>
<h3 id="block-bitmap"><a href="#block-bitmap" class="headerlink" title="block bitmap"></a>block bitmap</h3><p>记录使用与未使用的block编号</p>
<h3 id="inode-bitmap"><a href="#inode-bitmap" class="headerlink" title="inode bitmap"></a>inode bitmap</h3><p>记录使用与未使用的inode编号</p>
<h2 id="dumpe2fs-查詢-Ext-家族-superblock-信息"><a href="#dumpe2fs-查詢-Ext-家族-superblock-信息" class="headerlink" title="dumpe2fs:查詢 Ext 家族 superblock 信息"></a>dumpe2fs:查詢 Ext 家族 superblock 信息</h2><pre><code>命令:dumpe2fs [-bh] 装置名称
选项及参数:
    -b ：列出保留为坏轨的部分
    -h : 仅列出superblock的资料,不列出其他区段内容
</code></pre>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">root@CentOS7</span> <span class="string">~</span>]<span class="comment"># dumpe2fs /dev/sda5</span></span><br><span class="line"><span class="string">dumpe2fs</span> <span class="number">1.42</span><span class="number">.9</span> <span class="string">(28-Dec-2013)</span></span><br><span class="line"><span class="attr">Filesystem volume name:</span>   <span class="string">&lt;none&gt;</span>                 <span class="comment">#文件系统的名称</span></span><br><span class="line"><span class="attr">Last mounted on:</span>          <span class="string">&lt;not</span> <span class="string">available&gt;</span>        <span class="comment">#上一次挂载的目录位置</span></span><br><span class="line"><span class="attr">Filesystem UUID:</span>          <span class="string">548565b7-c9aa-4f69-ad70-c9c0770a96bc</span>  <span class="comment">#UUID</span></span><br><span class="line"><span class="attr">Filesystem magic number:</span>  <span class="number">0xEF53</span></span><br><span class="line"><span class="string">Filesystem</span> <span class="string">revision</span> <span class="comment">#:    1 (dynamic)</span></span><br><span class="line"><span class="attr">Filesystem features:</span>      <span class="string">has_journal</span> <span class="string">ext_attr</span> <span class="string">resize_inode</span> <span class="string">dir_index</span> <span class="string">filetype</span> <span class="comment">#文件系统的特殊资料</span></span><br><span class="line"><span class="string">extent</span> <span class="string">64bit</span> <span class="string">flex_bg</span> <span class="string">sparse_super</span> <span class="string">large_file</span> <span class="string">huge_file</span> <span class="string">uninit_bg</span> <span class="string">dir_nlink</span> <span class="string">extra_isize</span></span><br><span class="line"><span class="attr">Filesystem flags:</span>         <span class="string">signed_directory_hash</span></span><br><span class="line"><span class="attr">Default mount options:</span>    <span class="string">user_xattr</span> <span class="string">acl</span>         <span class="comment">#默认挂载参数</span></span><br><span class="line"><span class="attr">Filesystem state:</span>         <span class="string">clean</span>                  <span class="comment">#文件系统状态如何,clean表示没有问题</span></span><br><span class="line"><span class="attr">Errors behavior:</span>          <span class="string">Continue</span></span><br><span class="line"><span class="attr">Filesystem OS type:</span>       <span class="string">Linux</span></span><br><span class="line"><span class="attr">Inode count:</span>              <span class="number">65536</span>                  <span class="comment">#inode数量</span></span><br><span class="line"><span class="attr">Block count:</span>              <span class="number">262144</span>                 <span class="comment">#block数量</span></span><br><span class="line"><span class="attr">Reserved block count:</span>     <span class="number">13107</span>                  <span class="comment">#保留的block数量</span></span><br><span class="line"><span class="attr">Free blocks:</span>              <span class="number">249189</span>                 <span class="comment">#可用的block数量</span></span><br><span class="line"><span class="attr">Free inodes:</span>              <span class="number">65525</span>                  <span class="comment">#可用的inode数量</span></span><br><span class="line"><span class="attr">First block:</span>              <span class="number">0</span></span><br><span class="line"><span class="attr">Block size:</span>               <span class="number">4096</span>                   <span class="comment">#单个block大小</span></span><br><span class="line"><span class="attr">Fragment size:</span>            <span class="number">4096</span></span><br><span class="line"><span class="attr">Group descriptor size:</span>    <span class="number">64</span></span><br><span class="line"><span class="attr">Reserved GDT blocks:</span>      <span class="number">127</span></span><br><span class="line"><span class="attr">Blocks per group:</span>         <span class="number">32768</span></span><br><span class="line"><span class="attr">Fragments per group:</span>      <span class="number">32768</span></span><br><span class="line"><span class="attr">Inodes per group:</span>         <span class="number">8192</span></span><br><span class="line"><span class="attr">Inode blocks per group:</span>   <span class="number">512</span></span><br><span class="line"><span class="attr">Flex block group size:</span>    <span class="number">16</span></span><br><span class="line"><span class="attr">Filesystem created:</span>       <span class="string">Mon</span> <span class="string">Mar</span>  <span class="number">6</span> <span class="number">21</span><span class="string">:39:54</span> <span class="number">2017</span></span><br><span class="line"><span class="attr">Last mount time:</span>          <span class="string">n/a</span></span><br><span class="line"><span class="attr">Last write time:</span>          <span class="string">Mon</span> <span class="string">Mar</span>  <span class="number">6</span> <span class="number">21</span><span class="string">:39:54</span> <span class="number">2017</span></span><br><span class="line"><span class="attr">Mount count:</span>              <span class="number">0</span></span><br><span class="line"><span class="attr">Maximum mount count:</span>      <span class="number">-1</span></span><br><span class="line"><span class="attr">Last checked:</span>             <span class="string">Mon</span> <span class="string">Mar</span>  <span class="number">6</span> <span class="number">21</span><span class="string">:39:54</span> <span class="number">2017</span></span><br><span class="line"><span class="attr">Check interval:</span>           <span class="number">0</span> <span class="string">(&lt;none&gt;)</span></span><br><span class="line"><span class="attr">Lifetime writes:</span>          <span class="number">33</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">Reserved blocks uid:</span>      <span class="number">0</span> <span class="string">(user</span> <span class="string">root)</span></span><br><span class="line"><span class="attr">Reserved blocks gid:</span>      <span class="number">0</span> <span class="string">(group</span> <span class="string">root)</span></span><br><span class="line"><span class="attr">First inode:</span>              <span class="number">11</span></span><br><span class="line"><span class="attr">Inode size:</span>           <span class="number">256</span>                        <span class="comment">#inode大小</span></span><br><span class="line"><span class="attr">Required extra isize:</span>     <span class="number">28</span></span><br><span class="line"><span class="attr">Desired extra isize:</span>      <span class="number">28</span></span><br><span class="line"><span class="attr">Journal inode:</span>            <span class="number">8</span></span><br><span class="line"><span class="attr">Default directory hash:</span>   <span class="string">half_md4</span></span><br><span class="line"><span class="attr">Directory Hash Seed:</span>      <span class="string">22b8aec1-bacf-43f4-a185-b0a3fa13515a</span></span><br><span class="line"><span class="attr">Journal backup:</span>           <span class="string">inode</span> <span class="string">blocks</span></span><br><span class="line"><span class="attr">Journal features:</span>         <span class="string">(none)</span></span><br><span class="line"><span class="string">日志大小:</span>             <span class="string">32M</span></span><br><span class="line"><span class="attr">Journal length:</span>           <span class="number">8192</span></span><br><span class="line"><span class="attr">Journal sequence:</span>         <span class="number">0x00000001</span></span><br><span class="line"><span class="attr">Journal start:</span>            <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">Group 0:</span> <span class="string">(Blocks</span> <span class="number">0</span><span class="number">-32767</span><span class="string">)</span>                        <span class="comment">#第一块block位置</span></span><br><span class="line">  <span class="string">Checksum</span> <span class="number">0x0d99</span><span class="string">,</span> <span class="string">unused</span> <span class="string">inodes</span> <span class="number">8181</span></span><br><span class="line">  <span class="string">主</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">0</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">1</span><span class="number">-1</span>   <span class="comment">#主要superblock 的在</span></span><br><span class="line">  <span class="string">保留的GDT块位于</span> <span class="number">2</span><span class="number">-128</span></span><br><span class="line">  <span class="string">Block</span> <span class="string">bitmap</span> <span class="string">at</span> <span class="number">129</span> <span class="string">(+129),</span> <span class="string">Inode</span> <span class="string">bitmap</span> <span class="string">at</span> <span class="number">145</span> <span class="string">(+145)</span></span><br><span class="line">  <span class="string">Inode表位于</span> <span class="number">161</span><span class="number">-672</span> <span class="string">(+161)</span></span><br><span class="line">  <span class="number">28521</span> <span class="string">free</span> <span class="string">blocks,</span> <span class="number">8181 </span><span class="string">free</span> <span class="string">inodes,</span> <span class="number">2</span> <span class="string">directories,</span> <span class="number">8181</span><span class="string">个未使用的inodes</span>    <span class="comment">#剩余block,inode个数</span></span><br><span class="line">  <span class="string">可用块数:</span> <span class="number">142</span><span class="number">-144</span><span class="string">,</span> <span class="number">153</span><span class="number">-160</span><span class="string">,</span> <span class="number">4258</span><span class="number">-32767</span></span><br><span class="line">  <span class="string">可用inode数:</span> <span class="number">12</span><span class="number">-8192</span></span><br><span class="line"><span class="attr">Group 1:</span> <span class="string">(Blocks</span> <span class="number">32768</span><span class="number">-65535</span><span class="string">)</span> [<span class="string">INODE_UNINIT</span>]</span><br><span class="line">  <span class="string">Checksum</span> <span class="number">0xeaf5</span><span class="string">,</span> <span class="string">unused</span> <span class="string">inodes</span> <span class="number">8192</span></span><br><span class="line">  <span class="string">备份</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">32768</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">32769</span><span class="number">-32769</span></span><br><span class="line">  <span class="string">保留的GDT块位于</span> <span class="number">32770</span><span class="number">-32896</span></span><br><span class="line">  <span class="string">Block</span> <span class="string">bitmap</span> <span class="string">at</span> <span class="number">130</span> <span class="string">(bg</span> <span class="comment">#0 + 130), Inode bitmap at 146 (bg #0 + 146)</span></span><br><span class="line">  <span class="string">Inode表位于</span> <span class="number">673</span><span class="number">-1184</span> <span class="string">(bg</span> <span class="comment">#0 + 673)</span></span><br><span class="line">  <span class="number">32639</span> <span class="string">free</span> <span class="string">blocks,</span> <span class="number">8192 </span><span class="string">free</span> <span class="string">inodes,</span> <span class="number">0</span> <span class="string">directories,</span> <span class="number">8192</span><span class="string">个未使用的inodes</span></span><br><span class="line">  <span class="string">可用块数:</span> <span class="number">32897</span><span class="number">-65535</span></span><br><span class="line">  <span class="string">可用inode数:</span> <span class="number">8193</span><span class="number">-16384</span></span><br><span class="line"><span class="attr">Group 2:</span> <span class="string">(Blocks</span> <span class="number">65536</span><span class="number">-98303</span><span class="string">)</span> [<span class="string">INODE_UNINIT</span>, <span class="string">BLOCK_UNINIT</span>]</span><br><span class="line">  <span class="string">Checksum</span> <span class="number">0x5f38</span><span class="string">,</span> <span class="string">unused</span> <span class="string">inodes</span> <span class="number">8192</span></span><br><span class="line">  <span class="string">Block</span> <span class="string">bitmap</span> <span class="string">at</span> <span class="number">131</span> <span class="string">(bg</span> <span class="comment">#0 + 131), Inode bitmap at 147 (bg #0 + 147)</span></span><br><span class="line">  <span class="string">Inode表位于</span> <span class="number">1185</span><span class="number">-1696</span> <span class="string">(bg</span> <span class="comment">#0 + 1185)</span></span><br><span class="line">  <span class="number">32768</span> <span class="string">free</span> <span class="string">blocks,</span> <span class="number">8192 </span><span class="string">free</span> <span class="string">inodes,</span> <span class="number">0</span> <span class="string">directories,</span> <span class="number">8192</span><span class="string">个未使用的inodes</span></span><br><span class="line">  <span class="string">可用块数:</span> <span class="number">65536</span><span class="number">-98303</span></span><br><span class="line">  <span class="string">可用inode数:</span> <span class="number">16385</span><span class="number">-24576</span></span><br><span class="line"><span class="attr">Group 3:</span> <span class="string">(Blocks</span> <span class="number">98304</span><span class="number">-131071</span><span class="string">)</span> [<span class="string">INODE_UNINIT</span>]</span><br><span class="line">  <span class="string">Checksum</span> <span class="number">0xb23b</span><span class="string">,</span> <span class="string">unused</span> <span class="string">inodes</span> <span class="number">8192</span></span><br><span class="line">  <span class="string">备份</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">98304</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">98305</span><span class="number">-98305</span></span><br><span class="line">  <span class="string">保留的GDT块位于</span> <span class="number">98306</span><span class="number">-98432</span></span><br><span class="line">  <span class="string">Block</span> <span class="string">bitmap</span> <span class="string">at</span> <span class="number">132</span> <span class="string">(bg</span> <span class="comment">#0 + 132), Inode bitmap at 148 (bg #0 + 148)</span></span><br><span class="line">  <span class="string">Inode表位于</span> <span class="number">1697</span><span class="number">-2208</span> <span class="string">(bg</span> <span class="comment">#0 + 1697)</span></span><br><span class="line">  <span class="number">32639</span> <span class="string">free</span> <span class="string">blocks,</span> <span class="number">8192 </span><span class="string">free</span> <span class="string">inodes,</span> <span class="number">0</span> <span class="string">directories,</span> <span class="number">8192</span><span class="string">个未使用的inodes</span></span><br><span class="line">  <span class="string">可用块数:</span> <span class="number">98433</span><span class="number">-131071</span></span><br><span class="line">  <span class="string">可用inode数:</span> <span class="number">24577</span><span class="number">-32768</span></span><br><span class="line"><span class="attr">Group 4:</span> <span class="string">(Blocks</span> <span class="number">131072</span><span class="number">-163839</span><span class="string">)</span> [<span class="string">INODE_UNINIT</span>]</span><br><span class="line">  <span class="string">Checksum</span> <span class="number">0xa1b8</span><span class="string">,</span> <span class="string">unused</span> <span class="string">inodes</span> <span class="number">8192</span></span><br><span class="line">  <span class="string">Block</span> <span class="string">bitmap</span> <span class="string">at</span> <span class="number">133</span> <span class="string">(bg</span> <span class="comment">#0 + 133), Inode bitmap at 149 (bg #0 + 149)</span></span><br><span class="line">  <span class="string">Inode表位于</span> <span class="number">2209</span><span class="number">-2720</span> <span class="string">(bg</span> <span class="comment">#0 + 2209)</span></span><br><span class="line">  <span class="number">24576</span> <span class="string">free</span> <span class="string">blocks,</span> <span class="number">8192 </span><span class="string">free</span> <span class="string">inodes,</span> <span class="number">0</span> <span class="string">directories,</span> <span class="number">8192</span><span class="string">个未使用的inodes</span></span><br><span class="line">  <span class="string">可用块数:</span> <span class="number">139264</span><span class="number">-163839</span></span><br><span class="line">  <span class="string">可用inode数:</span> <span class="number">32769</span><span class="number">-40960</span></span><br><span class="line"><span class="attr">Group 5:</span> <span class="string">(Blocks</span> <span class="number">163840</span><span class="number">-196607</span><span class="string">)</span> [<span class="string">INODE_UNINIT</span>]</span><br><span class="line">  <span class="string">Checksum</span> <span class="number">0x9376</span><span class="string">,</span> <span class="string">unused</span> <span class="string">inodes</span> <span class="number">8192</span></span><br><span class="line">  <span class="string">备份</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">163840</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">163841</span><span class="number">-163841</span></span><br><span class="line">  <span class="string">保留的GDT块位于</span> <span class="number">163842</span><span class="number">-163968</span></span><br><span class="line">  <span class="string">Block</span> <span class="string">bitmap</span> <span class="string">at</span> <span class="number">134</span> <span class="string">(bg</span> <span class="comment">#0 + 134), Inode bitmap at 150 (bg #0 + 150)</span></span><br><span class="line">  <span class="string">Inode表位于</span> <span class="number">2721</span><span class="number">-3232</span> <span class="string">(bg</span> <span class="comment">#0 + 2721)</span></span><br><span class="line">  <span class="number">32639</span> <span class="string">free</span> <span class="string">blocks,</span> <span class="number">8192 </span><span class="string">free</span> <span class="string">inodes,</span> <span class="number">0</span> <span class="string">directories,</span> <span class="number">8192</span><span class="string">个未使用的inodes</span></span><br><span class="line">  <span class="string">可用块数:</span> <span class="number">163969</span><span class="number">-196607</span></span><br><span class="line">  <span class="string">可用inode数:</span> <span class="number">40961</span><span class="number">-49152</span></span><br><span class="line"><span class="attr">Group 6:</span> <span class="string">(Blocks</span> <span class="number">196608</span><span class="number">-229375</span><span class="string">)</span> [<span class="string">INODE_UNINIT</span>, <span class="string">BLOCK_UNINIT</span>]</span><br><span class="line">  <span class="string">Checksum</span> <span class="number">0x26bb</span><span class="string">,</span> <span class="string">unused</span> <span class="string">inodes</span> <span class="number">8192</span></span><br><span class="line">  <span class="string">Block</span> <span class="string">bitmap</span> <span class="string">at</span> <span class="number">135</span> <span class="string">(bg</span> <span class="comment">#0 + 135), Inode bitmap at 151 (bg #0 + 151)</span></span><br><span class="line">  <span class="string">Inode表位于</span> <span class="number">3233</span><span class="number">-3744</span> <span class="string">(bg</span> <span class="comment">#0 + 3233)</span></span><br><span class="line">  <span class="number">32768</span> <span class="string">free</span> <span class="string">blocks,</span> <span class="number">8192 </span><span class="string">free</span> <span class="string">inodes,</span> <span class="number">0</span> <span class="string">directories,</span> <span class="number">8192</span><span class="string">个未使用的inodes</span></span><br><span class="line">  <span class="string">可用块数:</span> <span class="number">196608</span><span class="number">-229375</span></span><br><span class="line">  <span class="string">可用inode数:</span> <span class="number">49153</span><span class="number">-57344</span></span><br><span class="line"><span class="attr">Group 7:</span> <span class="string">(Blocks</span> <span class="number">229376</span><span class="number">-262143</span><span class="string">)</span> [<span class="string">INODE_UNINIT</span>]</span><br><span class="line">  <span class="string">Checksum</span> <span class="number">0x03a7</span><span class="string">,</span> <span class="string">unused</span> <span class="string">inodes</span> <span class="number">8192</span></span><br><span class="line">  <span class="string">备份</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">229376</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">229377</span><span class="number">-229377</span></span><br><span class="line">  <span class="string">保留的GDT块位于</span> <span class="number">229378</span><span class="number">-229504</span></span><br><span class="line">  <span class="string">Block</span> <span class="string">bitmap</span> <span class="string">at</span> <span class="number">136</span> <span class="string">(bg</span> <span class="comment">#0 + 136), Inode bitmap at 152 (bg #0 + 152)</span></span><br><span class="line">  <span class="string">Inode表位于</span> <span class="number">3745</span><span class="number">-4256</span> <span class="string">(bg</span> <span class="comment">#0 + 3745)</span></span><br><span class="line">  <span class="number">32639</span> <span class="string">free</span> <span class="string">blocks,</span> <span class="number">8192 </span><span class="string">free</span> <span class="string">inodes,</span> <span class="number">0</span> <span class="string">directories,</span> <span class="number">8192</span><span class="string">个未使用的inodes</span></span><br><span class="line">  <span class="string">可用块数:</span> <span class="number">229505</span><span class="number">-262143</span></span><br><span class="line">  <span class="string">可用inode数:</span> <span class="number">57345</span><span class="number">-65536</span></span><br></pre></td></tr></table></figure>

<h2 id="与目录树的关系"><a href="#与目录树的关系" class="headerlink" title="与目录树的关系"></a>与目录树的关系</h2><p>当在Linux下的文件系统建立一个目录时,文件系统会分配一个inode与至少一个block给该目录。inode记录目录相关权限与属性,并可记录分配的那块block号码,而block则是记录在这这个目录下的文件名与该文件名占用inode号码资料。</p>
<h3 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h3><p>当在Linux下的ext2建立一个一般文件时,ext2会分配一个inode与与相对于该文件大小的block数量给该文件。</p>
<h3 id="目录树读取"><a href="#目录树读取" class="headerlink" title="目录树读取"></a>目录树读取</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[haokaiyang@CentOS7 ~]$ ll -di / /etc /etc/passwd</span><br><span class="line">       64 dr-xr-xr-x.  17 root root  233 2月  27 18:05 /</span><br><span class="line">134320193 drwxr-xr-x. 134 root root 8192 3月   6 11:44 /etc</span><br><span class="line">135729834 -rw-r--r--.   1 root root 2328 3月   1 18:07 /etc/passwd</span><br></pre></td></tr></table></figure>
<p>该文件读取流程为(假设使用者是haokaiyang)</p>
<ol>
<li>&#x2F;的inode<br>    通过挂载点的信息找到inode号码为64的根目录inode,且inode规范的权限让我们读取block内容</li>
<li>&#x2F;的block<br>    取得block号码,并找到该内容有etc目录的inode号码134320193</li>
<li>etc&#x2F;的inode<br>    读取134320193 号码得知haokaiyang具有rx权限,因此可以获取&#x2F;etc的block内容</li>
<li>etc&#x2F;的block<br>    取得block号码,并找到该内容有passwd文件的inode号码135729834</li>
<li>passwd的inode<br>    读取135729834号inode得知haokaiyang具有r权限,可以读取</li>
<li>passwd的block<br>   读出block内容</li>
</ol>
<h3 id="当新建一个文件时候-文件系统的行为是"><a href="#当新建一个文件时候-文件系统的行为是" class="headerlink" title="当新建一个文件时候,文件系统的行为是"></a>当新建一个文件时候,文件系统的行为是</h3><ol>
<li>先确定使用者对新增目录是否具有w与x的权限,若有的话才显示</li>
<li>根据inode bitmap找到没有使用的inode号码,并将文件新权限写入</li>
<li>根据block bitmp找到没有使用的中的block号码,并将文件内容写入block,且更新inode指向block的指向资料</li>
<li>将刚刚写入的inode与block资料同步更新inode bitmap与block bitmap,并更新superblock的内容。</li>
</ol>
<p>所以一般将inode table与data block称为资料存放区域,其它比如superblock、block bitmap与inode bitmap等区段就称为metadata.因为经常变动,每次新增、移除、编辑都可能会影响到这三个部分的资料。</p>
<p>为了避免档案在写入档案系统的时候,因为各种原因导致系统中断,写入的资料仅有inode table及data block (metadata的内容与实际资料存放区不一致问题);所以兴起了日志式文件系统</p>
<ol>
<li>准备:当系统要写入一个档案时,会先在日志记录区块中记录某个文件准备要写入的信息</li>
<li>实际写入:开始写入文件的权限与资料;开始更新metadata的资料</li>
<li>结束:完成资料与meta的更新后,在日志记录区块当中完成该档案的记录。</li>
</ol>
<p>这样万一资料记录过程出现了问题,系统只需要去检查日志记录区块,就可以知道哪个文件发生了问题,针对问题来做一致性检查就可以了,而不必针对整块filesystem去检查。</p>
<h2 id="Linux文件系统的运作"><a href="#Linux文件系统的运作" class="headerlink" title="Linux文件系统的运作"></a>Linux文件系统的运作</h2><p>所有的文件都要载入到内存后CPU才能够对文件进行处理,如果编辑大文件,在编辑过程中频繁要系统写入硬盘,由于硬盘写入速度比内存慢,可能会将时间耗在硬盘I&#x2F;O上。为了解决这个问题,Linux使用了异步处理(asynchronously)的方式:</p>
<p>当系统载入一个文件到内存后,如果文件没有改动,则在内存区块的文件资料会被设定会clean的.如果文件有改动,则为dirty,这时所有动作都还在内存中,并没有写入硬盘.系统会不定时将dirty的资料写入硬盘,以保持硬盘与内存资料一致。(sync来手动强迫写入硬盘)</p>
<p>Linux上文件系统与内存的关系:</p>
<ul>
<li>系统会将常用的资料放置到内存的缓存区,以加速文件系统的读写</li>
<li>Linux的内存被用光是正常情况,可以加速系统性能。</li>
<li>可以手动sync来强迫内存中dirty文件写入到硬盘</li>
<li>正常关机时,关机指令会自动呼叫sync将内存中资料写入硬盘</li>
<li>如果不正常关机(跳电、当机、或其他不明原因),由于资料尚未写入硬盘,重新开机会花很多时间进行硬盘检查,甚至可能损坏文件系统(非硬盘损坏)</li>
</ul>
<h3 id="mount-point的意义"><a href="#mount-point的意义" class="headerlink" title="mount point的意义"></a>mount point的意义</h3><p>挂载点一定是目录,该目录是进入文件系统的入口<br>证明 &#x2F; 的上级目录和上上级目录都是&#x2F;的办法</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[haokaiyang@CentOS7 ~]$ ll -di / /. /..</span><br><span class="line">64 dr-xr-xr-x. 17 root root 233 2月  27 18:05 /</span><br><span class="line">64 dr-xr-xr-x. 17 root root 233 2月  27 18:05 /.</span><br><span class="line">64 dr-xr-xr-x. 17 root root 233 2月  27 18:05 /..</span><br></pre></td></tr></table></figure>

<p>能够被Linux支持的文件系统有:<br>传统文件系统:ext2&#x2F;minix&#x2F;MS-DOS&#x2F;FAT&#x2F;iso9660(光盘)等等<br>日志式文件系统:ext3&#x2F;ext4&#x2F;ReiserFS&#x2F;Windows’NTFS&#x2F;IBM’s JFS&#x2F;SGI’s XFS&#x2F;ZFS<br>网络文件系统:NFS&#x2F;SMBFS</p>
<p>查看Linux支持的文件系统有哪些.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l /lib/modules/$(<span class="built_in">uname</span> -r)/kernel/fs</span><br></pre></td></tr></table></figure>

<p>系统目前已经载入到内存中支持的文件系统有</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/filesystems</span><br></pre></td></tr></table></figure>
<p>整个Linux的系统是通过一个名为Virtual Filesystem Switch的核心去读取filesystem的。<br>EXT家族支持度很广,但是格式化超级慢。所以CentOS7开始,默认的文件系统已经由原本的EXT4变成了XFS了。\</p>
<h3 id="xfs文件系统的规划"><a href="#xfs文件系统的规划" class="headerlink" title="xfs文件系统的规划"></a>xfs文件系统的规划</h3><p>在资料的分布上,xfs文件系统主要规划为三个部分</p>
<h4 id="资料区-data-section"><a href="#资料区-data-section" class="headerlink" title="资料区(data section)"></a>资料区(data section)</h4><p>资料区放置了inode&#x2F;data block&#x2F;superblock等资料,也分为多个储存区群组(allocation groups)来分别防止档案系统所需要的资料。每个群组包含了</p>
<ol>
<li>整个文件系统的superblock</li>
<li>剩余空间的管理机制</li>
<li>inode的分配与追踪<br>   inode和block都是系统需要时候,动态配置产生的,所以格式化比较快</li>
</ol>
<p>  与ext家族的不同:<br>  xfs的block与inode有多种不同的容量可以设定,block容量可以在512bytes-64K调配.不过由于Linux下内存的关系(pagesize的容量问题).最高的block大小为4K至于inode容量可以在256bytes-2M之间调配</p>
<h4 id="档案系统活动登录区-log-section"><a href="#档案系统活动登录区-log-section" class="headerlink" title="档案系统活动登录区(log section)"></a>档案系统活动登录区(log section)</h4><p>主要用来记录文件系统变化。系统的所有动作都会在这个区块做个记录。因此这个区块的硬盘活动比较频繁。在这个区域,可以指定外部的硬盘来作为xfs文件系统的日志区块。</p>
<h4 id="即时运作区-realtime-section"><a href="#即时运作区-realtime-section" class="headerlink" title="即时运作区(realtime section)"></a>即时运作区(realtime section)</h4><p>当创建文件时,xfs会在这个区块找一个到数个extent区块,将文件放置在这个区块内,等到分配完毕后,再写入到data section的inode和block去。这个extent区块的大小在格式化的时候就先指定,从4K-1G。一般非磁盘阵列默认为64K,而具有磁盘阵列的stripe情况下,建议extent和stripe一样大。extent最好不要乱动,可能会影响到硬盘的效率。</p>
<h3 id="xfs文件系统的描述信息"><a href="#xfs文件系统的描述信息" class="headerlink" title="xfs文件系统的描述信息"></a>xfs文件系统的描述信息</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#找出系统/boot这个挂载点下的文件系统的superblock记录</span></span><br><span class="line">[haokaiyang@CentOS7 ~]$ df -T /boot/</span><br><span class="line">文件系统       类型   1K-块   已用   可用 已用% 挂载点</span><br><span class="line">/dev/sda2      xfs  1038336 175704 862632   17% /boot</span><br><span class="line">[haokaiyang@CentOS7 ~]$ xfs_info /dev/sda</span><br><span class="line">sda   sda1  sda2  sda3  </span><br><span class="line">[haokaiyang@CentOS7 ~]$ xfs_info /dev/sda2</span><br><span class="line"><span class="attribute">meta-data</span>=/dev/sda2              <span class="attribute">isize</span>=512    <span class="attribute">agcount</span>=4, <span class="attribute">agsize</span>=65536 blks</span><br><span class="line">         =                       <span class="attribute">sectsz</span>=512   <span class="attribute">attr</span>=2, <span class="attribute">projid32bit</span>=1</span><br><span class="line">         =                       <span class="attribute">crc</span>=1        <span class="attribute">finobt</span>=0 <span class="attribute">spinodes</span>=0</span><br><span class="line">data     =                       <span class="attribute">bsize</span>=4096   <span class="attribute">blocks</span>=262144, <span class="attribute">imaxpct</span>=25</span><br><span class="line">         =                       <span class="attribute">sunit</span>=0      <span class="attribute">swidth</span>=0 blks</span><br><span class="line">naming   =version 2              <span class="attribute">bsize</span>=4096   <span class="attribute">ascii-ci</span>=0 <span class="attribute">ftype</span>=1</span><br><span class="line">log      =internal               <span class="attribute">bsize</span>=4096   <span class="attribute">blocks</span>=2560, <span class="attribute">version</span>=2</span><br><span class="line">         =                       <span class="attribute">sectsz</span>=512   <span class="attribute">sunit</span>=0 blks, <span class="attribute">lazy-count</span>=1</span><br><span class="line">realtime =none                   <span class="attribute">extsz</span>=4096   <span class="attribute">blocks</span>=0, <span class="attribute">rtextents</span>=0</span><br></pre></td></tr></table></figure>
<ul>
<li>第一行的isize是inode容量,每个有512bytes.agcount表示储存区群组有4个.agsize每个每个储存区群组有65536个block。第4行的block设定为4K,因此整个文件系统应该是4<em>65536</em>4K这么大</li>
<li>第2行中的sectsz指逻辑扇区的容量设定为512bytes</li>
<li>第4行里面的bsize指的是block的容量.每个block为4K,共有262144个block在这个文件系统中</li>
<li>第5行里面的sunit与swidth与磁盘阵列的stripe相关性比较高</li>
<li>第7行里的internal指的是这个登录区的位置在文件系统内,而不是外部设备。且占用了4K*2560个block,占用约10M容量</li>
<li>第9行realtime,extent容量为4K,不过目前没有使用。</li>
</ul>
<h2 id="文件系统的操作"><a href="#文件系统的操作" class="headerlink" title="文件系统的操作"></a>文件系统的操作</h2><h3 id="硬盘与目录容量"><a href="#硬盘与目录容量" class="headerlink" title="硬盘与目录容量"></a>硬盘与目录容量</h3><p>df:列出文件系统的整个磁盘使用量</p>
<pre><code>命令:df [-ahikHTm] [目录或文件名]
选项和参数: 
      -a 列出所有文件系统,包括系统特有的/proc等文件系统
      -k 以KBytes的容量显示各个文件系统
      -m 以MBytes的容量显示各个文件系统
      -h 以人们容量阅读的GBytes、MBytes、KBytes等格式展示
      -H 以M=1000K取代M=2014K的进位方式
      -T 连同该partition的filesystem名称(例如xfs)列出
      -i 不用磁盘容量,而以inode的数量来显示
</code></pre>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在Linux下,如果df没有加任何选项,那么默认会将系统中所有(不含特殊标记内存内的文件系统与swap)都以1Kbytes的容量来列出来</span></span><br><span class="line"><span class="regexp">/dev/</span>shm/其实是内存虚拟出来的硬盘空间,通常是内存的一半.</span><br><span class="line">[root@CentOS7 ~]<span class="comment"># df</span></span><br><span class="line">文件系统                    <span class="number">1</span>K-块    已用      可用 已用% 挂载点</span><br><span class="line"><span class="regexp">/dev/m</span>apper<span class="regexp">/centos-root 104806400 4452032 100354368    5% /</span></span><br><span class="line">devtmpfs                  <span class="number">1900852</span>       <span class="number">0</span>   <span class="number">1900852</span>    <span class="number">0</span>% /dev</span><br><span class="line">tmpfs                     <span class="number">1916484</span>     <span class="number">156</span>   <span class="number">1916328</span>    <span class="number">1</span>% <span class="regexp">/dev/</span>shm</span><br><span class="line">tmpfs                     <span class="number">1916484</span>    <span class="number">8904</span>   <span class="number">1907580</span>    <span class="number">1</span>% /run</span><br><span class="line">tmpfs                     <span class="number">1916484</span>       <span class="number">0</span>   <span class="number">1916484</span>    <span class="number">0</span>% <span class="regexp">/sys/</span>fs/cgroup</span><br><span class="line"><span class="regexp">/dev/</span>sda2                 <span class="number">1038336</span>  <span class="number">175704</span>    <span class="number">862632</span>   <span class="number">17</span>% /boot</span><br><span class="line"><span class="regexp">/dev/m</span>apper<span class="regexp">/centos-home  20961280   37748  20923532    1% /</span>home</span><br><span class="line">tmpfs                      <span class="number">383300</span>      <span class="number">16</span>    <span class="number">383284</span>    <span class="number">1</span>% <span class="regexp">/run/u</span>ser/<span class="number">1000</span></span><br><span class="line"><span class="regexp">/dev/</span>sr0                    <span class="number">57978</span>   <span class="number">57978</span>         <span class="number">0</span>  <span class="number">100</span>% <span class="regexp">/run/m</span>edia<span class="regexp">/haokaiyang/</span>VBOXADDITIONS_5.<span class="number">1.14</span>_112924</span><br><span class="line"><span class="comment">#将/etc底下的可用的应聘容量以易读的容量格式展示</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># df -h /etc/</span></span><br><span class="line">文件系统                 容量  已用  可用 已用% 挂载点</span><br><span class="line"><span class="regexp">/dev/m</span>apper<span class="regexp">/centos-root  100G  4.3G   96G    5% /</span></span><br></pre></td></tr></table></figure>


<p>du:评估文件系统的硬盘使用量</p>
<pre><code>命令: du [-ahskm] 目录或文件名
选项和参数:
    -a 列出所有文件与目录容量,因为默认只统计目录底下的文件量
    -k 以KBytes的容量显示各个文件系统
    -m 以MBytes的容量显示各个文件系统
    -h 以人们容量阅读的(G/M)等格式展示
    -s 列出总量而且,而不列出每个各别的目录占用容量
    -S 不包括子目录下的统计,与-s有点差别
</code></pre>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#检查根目录下每个目录所占用的容量</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># du -sh /*</span></span><br></pre></td></tr></table></figure>

<h3 id="硬链接与软链接"><a href="#硬链接与软链接" class="headerlink" title="硬链接与软链接"></a>硬链接与软链接</h3><p>Hard Link</p>
<p>多个文件对应同一个inode.hard link只是在某个目录下新增了一个文件名链接到某inode号码的关联记录。只会在某个目录下的block多写入一个关联资料。不会增加inode也不会耗用block数量,所以hard的限制不能跨filesystem,也不能link目录</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]<span class="comment"># ll -i /etc/crontab </span></span><br><span class="line">134900596 -rw-r--r--. 1 root root 451 6月  10 2014 /etc/crontab</span><br><span class="line"><span class="comment">#创建硬链接</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># ln /etc/crontab .</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># ll -i /etc/crontab ./crontab </span></span><br><span class="line">134900596 -rw-r--r--. 2 root root 451 6月  10 2014 ./crontab</span><br><span class="line">134900596 -rw-r--r--. 2 root root 451 6月  10 2014 /etc/crontab</span><br><span class="line"><span class="comment">#inode一样,第二个栏位的1也变成2.</span></span><br></pre></td></tr></table></figure>

<p>Symbolic Link</p>
<p>symbolic link就是在建立一个独立的文件,这个文件会让资料的读取指向他link的那个文件的文件名.和windows下的快捷方式类似。会占用掉inode与block。所有当来源删除后,symbolic link会打不开。两个文件指向不同的inode号码。链接重要内容就是他会写上目标文件的文件名.[&#x2F;etc&#x2F;crontab]总有12个英文.每个英文占用一个bytes.所以文件大小就是12bytes了。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]<span class="comment"># ln -s /etc/crontab crontab2</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># ll -i /etc/crontab /root/crontab2</span></span><br><span class="line">134900596 -rw-r--r--. 2 root root 451 6月  10 2014 /etc/crontab</span><br><span class="line">201430482 lrwxrwxrwx. 1 root root  12 3月   6 16:40 /root/crontab2 -&gt; /etc/crontab</span><br></pre></td></tr></table></figure>

<pre><code>命令:ln [-sf] 源文件 目标文件
选项和参数:
    -s 不加参数为hardlink ,加上参数为symbolic link
    -f 如果目标文件存在时,将目标文件删除后再建立
</code></pre>
<p>目录的link数量:<br>新建一个目录时候,新的目录link数为2,而上层则会增加1</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 新建一个目录时候/tmp/testing/ 和/tmp/testing/. 是一样的,代表该目录,/tmp/testing/..则代表上层目录</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># ls -ld /tmp</span></span><br><span class="line">drwxrwxrwt. 21 root root 4096 3月   6 16:52 /tmp</span><br><span class="line">[root@CentOS7 ~]<span class="comment"># mkdir /tmp/testing2</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># ls -ld /tmp/ /tmp/testing2</span></span><br><span class="line">drwxrwxrwt. 22 root root 4096 3月   6 16:52 /tmp/</span><br><span class="line">drwxr-xr-x.  2 root root    6 3月   6 16:52 /tmp/testing2</span><br></pre></td></tr></table></figure>

<h2 id="硬盘的分割、格式化、检验与挂载"><a href="#硬盘的分割、格式化、检验与挂载" class="headerlink" title="硬盘的分割、格式化、检验与挂载"></a>硬盘的分割、格式化、检验与挂载</h2><h3 id="观察硬盘分割状态"><a href="#观察硬盘分割状态" class="headerlink" title="观察硬盘分割状态"></a>观察硬盘分割状态</h3><p>想要在系统里新增一颗硬盘时候需要做的事情:</p>
<ol>
<li>对硬盘进行分割,建立可用的partition</li>
<li>对该partition进行format,以建立系统可用的filesystem</li>
<li>若想要仔细一点,则对刚建立好的filesystem进行检验</li>
<li>在Linux系统上,建立挂载点.并将硬盘挂载上来.</li>
</ol>
<h4 id="lsblk列出系统上所有的硬盘列表-list-block-device"><a href="#lsblk列出系统上所有的硬盘列表-list-block-device" class="headerlink" title="lsblk列出系统上所有的硬盘列表( list block device)"></a>lsblk列出系统上所有的硬盘列表( list block device)</h4><pre><code>命令:lsblk [-dfimpt] [device]
选项和参数:
    -d 仅列出硬盘本身,不会列出该硬盘的分割资料
    -f 同时列出该硬盘内的文件系统名称
    -i 使用ASCII的线段输出,不要使用复杂的编码
    -m 同时输出该装置在/dev底下的权限资料(rwx的资料)
    -p 列出该装置的完整文件名,而不是仅列出最后的名字
    -t 列出该硬盘装置的详细资料,包括磁盘队列机制、默认写的资料量大小等
</code></pre>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#列出本系统下所有硬盘与硬盘内的分割信息</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># lsblk</span></span><br><span class="line">NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sda               8:0    0  200G  0 disk </span><br><span class="line">├─sda1            8:1    0    2M  0 part </span><br><span class="line">├─sda2            8:2    0    1G  0 part /boot</span><br><span class="line">└─sda3            8:3    0  150G  0 part </span><br><span class="line">  ├─centos-root 253:0    0  100G  0 lvm  /</span><br><span class="line">  ├─centos-swap 253:1    0    4G  0 lvm  [SWAP]</span><br><span class="line">  └─centos-home 253:2    0   20G  0 lvm  /home</span><br><span class="line">sr0              11:0    1 56.6M  0 rom  </span><br></pre></td></tr></table></figure>
<p>目前的系统有个sr0以及一个sda装置.而sda下有三个分割.其中sda3设置还有LVM产生的文件系统<br>NAME 文件名,会省略&#x2F;dev<br>MAJ MIN 主要:次要装置代码<br>RM 是否为可卸载装置(removable device),如光盘、U盘<br>SIZE 容量<br>RO 是否只读装置<br>TYPE 类型 硬盘(disk)、分割槽(partition)还是只读内存(rom)等输出<br>MOUNTPOINT 挂载点</p>
<h4 id="blkid列出装置的UUID等参数"><a href="#blkid列出装置的UUID等参数" class="headerlink" title="blkid列出装置的UUID等参数"></a>blkid列出装置的UUID等参数</h4><p>UUID是全球单一识别码(universally unique identifier),Linux会给系统内所有的装置都给予一个独一无二的识别码<br>这个识别码可以拿来作为挂载点或者使用这个装置&#x2F;文件系统之用</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]<span class="comment"># blkid</span></span><br><span class="line"><span class="regexp">/dev/</span>sda1: PARTUUID=<span class="string">&quot;42925040-87b8-45c8-8c8b-7361607e93cf&quot;</span> </span><br><span class="line"><span class="regexp">/dev/</span>sda2: UUID=<span class="string">&quot;87fdbc5c-2b5d-4f09-b26c-88bdcd4d2144&quot;</span> TYPE=<span class="string">&quot;xfs&quot;</span> PARTUUID=<span class="string">&quot;db746d09-3d43-46ca-a610-ee06c35f55ba&quot;</span> </span><br><span class="line"><span class="regexp">/dev/</span>sda3: UUID=<span class="string">&quot;dEe2aq-ytWb-BSQu-J4Ui-Yx0x-ilrn-FKk0IN&quot;</span> TYPE=<span class="string">&quot;LVM2_member&quot;</span> PARTUUID=<span class="string">&quot;3c7cab64-d98b-4453-9600-6c9a75bc6efc&quot;</span> </span><br><span class="line"><span class="regexp">/dev/m</span>apper/centos-root: UUID=<span class="string">&quot;dd92edb9-26bb-4fa3-965d-4ae98dfbe040&quot;</span> TYPE=<span class="string">&quot;xfs&quot;</span> </span><br><span class="line"><span class="regexp">/dev/m</span>apper/centos-swap: UUID=<span class="string">&quot;0c06f7c6-265d-4672-8ba3-32b045e22ee4&quot;</span> TYPE=<span class="string">&quot;swap&quot;</span> </span><br><span class="line"><span class="regexp">/dev/m</span>apper/centos-home: UUID=<span class="string">&quot;e033015e-1048-4c23-bbca-0536e6f326ec&quot;</span> TYPE=<span class="string">&quot;xfs&quot;</span> </span><br></pre></td></tr></table></figure>

<h3 id="硬盘分割"><a href="#硬盘分割" class="headerlink" title="硬盘分割"></a>硬盘分割</h3><h4 id="查看硬盘分割表类型与分割咨讯"><a href="#查看硬盘分割表类型与分割咨讯" class="headerlink" title="查看硬盘分割表类型与分割咨讯"></a>查看硬盘分割表类型与分割咨讯</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#命令:parted device_name print</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># parted /dev/sda print</span></span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)                <span class="comment">#硬盘模组名称(厂商)</span></span><br><span class="line">Disk /dev/sda: 215GB                           <span class="comment">#硬盘容量</span></span><br><span class="line">Sector size (logical/physical): 512B/512B      <span class="comment">#硬盘的每个逻辑/物理磁区容量</span></span><br><span class="line">Partition Table: gpt                           <span class="comment">#分割表格式(MBR/GPT)</span></span><br><span class="line">Disk Flags: pmbr_boot</span><br><span class="line"></span><br><span class="line">Number  Start   End     Size    File system  Name  标志   <span class="comment">#以下为分割资料</span></span><br><span class="line"> 1      1049kB  3146kB  2097kB                     bios_grub</span><br><span class="line"> 2      3146kB  1077MB  1074MB  xfs</span><br><span class="line"> 3      1077MB  162GB   161GB                      lvm</span><br></pre></td></tr></table></figure>
<p>MBR分割表使用fdisk分割,GPT分割表使用gdisk分割<br>gdisk</p>
<pre><code>命令:gdisk 装置名称
</code></pre>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]<span class="comment"># gdisk /dev/sda</span></span><br><span class="line">GPT fdisk (gdisk) version <span class="number">0.8</span>.<span class="number">6</span></span><br><span class="line"></span><br><span class="line">Partition table scan:</span><br><span class="line">  MBR: protective</span><br><span class="line">  BSD: <span class="keyword">not</span> present</span><br><span class="line">  APM: <span class="keyword">not</span> present</span><br><span class="line">  GPT: present</span><br><span class="line"></span><br><span class="line">Found valid GPT <span class="keyword">with</span> protective MBR; using GPT. &lt;==找到了GPT分割表</span><br><span class="line"></span><br><span class="line">Command (? <span class="keyword">for</span> help): ?   &lt;== 输入指令动作 ?查看可用命令</span><br><span class="line">b   back up GPT data <span class="keyword">to</span> a file</span><br><span class="line">c   change a partition<span class="string">\&#x27;s</span> name</span><br><span class="line">d   <span class="keyword">delete</span> a partition                     <span class="comment">#删除一个扇区</span></span><br><span class="line">i   show detailed information <span class="literal">on</span> a partition</span><br><span class="line">l   <span class="keyword">list</span> known partition types</span><br><span class="line">n   add a <span class="keyword">new</span> partition                    <span class="comment">#增加一个扇区</span></span><br><span class="line">o   create a <span class="keyword">new</span> empty GUID partition table (GPT)</span><br><span class="line">p   <span class="built_in">print</span> the partition table              <span class="comment">#打印出分割表</span></span><br><span class="line">q   quit without saving changes            <span class="comment">#不储存分割就直接离开gdisk</span></span><br><span class="line">r   recovery <span class="keyword">and</span> transformation options (experts only)</span><br><span class="line">s   sort partitions</span><br><span class="line">t   change a partition<span class="string">\&#x27;s</span> type code</span><br><span class="line">v   verify disk</span><br><span class="line">w   write table <span class="keyword">to</span> disk <span class="keyword">and</span> exit           <span class="comment">#储存分割后离开gdisk</span></span><br><span class="line">x   extra functionality (experts only)</span><br><span class="line">?   <span class="built_in">print</span> this menu</span><br><span class="line"></span><br><span class="line">Command (? <span class="keyword">for</span> help): ?</span><br><span class="line">Command (? <span class="keyword">for</span> help): p        <span class="comment">#&lt;==输出目前硬盘的状态</span></span><br><span class="line">Disk <span class="regexp">/dev/sda: 419430400 sectors, 200.0 GiB                         #硬盘文件/</span>磁区数与总容量</span><br><span class="line">Logical sector size: <span class="number">512</span> bytes                                      <span class="comment">#单一磁区大小为512bytes</span></span><br><span class="line">Disk identifier (GUID): A3D418CA-<span class="number">36</span>F0-<span class="number">4</span>B8F-<span class="number">9883</span>-<span class="number">079</span>D13FF5E56        <span class="comment">#硬盘的GPT识别码</span></span><br><span class="line">Partition table holds up <span class="keyword">to</span> <span class="number">128</span> entries</span><br><span class="line">First usable sector <span class="keyword">is</span> <span class="number">34</span>, last usable sector <span class="keyword">is</span> <span class="number">419430366</span></span><br><span class="line">Partitions will be aligned <span class="literal">on</span> <span class="number">2048</span>-sector boundaries</span><br><span class="line">Total free space <span class="keyword">is</span> <span class="number">102748093</span> sectors (<span class="number">49.0</span> GiB)</span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>  Start (sector)    End (sector)  Size       Code  Name       <span class="comment">#以下为完整分割资讯</span></span><br><span class="line">   <span class="number">1</span>            <span class="number">2048</span>            <span class="number">6143</span>   <span class="number">2.0</span> MiB     EF02             <span class="comment">#第一个扇区资料</span></span><br><span class="line">   <span class="number">2</span>            <span class="number">6144</span>         <span class="number">2103295</span>   <span class="number">1024.0</span> MiB  <span class="number">0700</span></span><br><span class="line">   <span class="number">3</span>         <span class="number">2103296</span>       <span class="number">316684287</span>   <span class="number">150.0</span> GiB   <span class="number">8E</span>00</span><br></pre></td></tr></table></figure>

<p>Number            扇区编号 1指的是&#x2F;dev&#x2F;sda1<br>Start (sector)    扇区开始磁区号码位置<br>End (sector)      扇区结束磁盘号码位置与start之间可以算出总量<br>Size              扇区容量<br>Code              在扇区内可能的文件系统类型,Linux为8300,swap为8200,只是提示而已,不见得真的代表扇区内档案资料<br>Name              文件系统名称</p>
<p>例子:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新增一个1GB的xfs文件系统(Linux)</span></span><br><span class="line"><span class="comment"># 新增一个1GB的vfat文件系统(Windows)</span></span><br><span class="line"><span class="comment"># 新增一个0.5GB的swap(Linux swap)</span></span><br><span class="line">[<span class="string">root@CentOS7</span> <span class="string">~</span>]<span class="comment"># gdisk /dev/sda</span></span><br><span class="line"><span class="string">GPT</span> <span class="string">fdisk</span> <span class="string">(gdisk)</span> <span class="string">version</span> <span class="number">0.8</span><span class="number">.6</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Partition table scan:</span></span><br><span class="line">  <span class="attr">MBR:</span> <span class="string">protective</span></span><br><span class="line">  <span class="attr">BSD:</span> <span class="string">not</span> <span class="string">present</span></span><br><span class="line">  <span class="attr">APM:</span> <span class="string">not</span> <span class="string">present</span></span><br><span class="line">  <span class="attr">GPT:</span> <span class="string">present</span></span><br><span class="line"></span><br><span class="line"><span class="string">Found</span> <span class="string">valid</span> <span class="string">GPT</span> <span class="string">with</span> <span class="string">protective</span> <span class="string">MBR;</span> <span class="string">using</span> <span class="string">GPT.</span></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">?</span></span><br><span class="line"><span class="string">b</span>   <span class="string">back</span> <span class="string">up</span> <span class="string">GPT</span> <span class="string">data</span> <span class="string">to</span> <span class="string">a</span> <span class="string">file</span></span><br><span class="line"><span class="string">c</span>   <span class="string">change</span> <span class="string">a</span> <span class="string">partition\&#x27;s</span> <span class="string">name</span></span><br><span class="line"><span class="string">d</span>   <span class="string">delete</span> <span class="string">a</span> <span class="string">partition</span></span><br><span class="line"><span class="string">i</span>   <span class="string">show</span> <span class="string">detailed</span> <span class="string">information</span> <span class="string">on</span> <span class="string">a</span> <span class="string">partition</span></span><br><span class="line"><span class="string">l</span>   <span class="string">list</span> <span class="string">known</span> <span class="string">partition</span> <span class="string">types</span></span><br><span class="line"><span class="string">n</span>   <span class="string">add</span> <span class="string">a</span> <span class="string">new</span> <span class="string">partition</span></span><br><span class="line"><span class="string">o</span>   <span class="string">create</span> <span class="string">a</span> <span class="string">new</span> <span class="string">empty</span> <span class="string">GUID</span> <span class="string">partition</span> <span class="string">table</span> <span class="string">(GPT)</span></span><br><span class="line"><span class="string">p</span>   <span class="string">print</span> <span class="string">the</span> <span class="string">partition</span> <span class="string">table</span></span><br><span class="line"><span class="string">q</span>   <span class="string">quit</span> <span class="string">without</span> <span class="string">saving</span> <span class="string">changes</span></span><br><span class="line"><span class="string">r</span>   <span class="string">recovery</span> <span class="string">and</span> <span class="string">transformation</span> <span class="string">options</span> <span class="string">(experts</span> <span class="string">only)</span></span><br><span class="line"><span class="string">s</span>   <span class="string">sort</span> <span class="string">partitions</span></span><br><span class="line"><span class="string">t</span>   <span class="string">change</span> <span class="string">a</span> <span class="string">partition\&#x27;s</span> <span class="string">type</span> <span class="string">code</span></span><br><span class="line"><span class="string">v</span>   <span class="string">verify</span> <span class="string">disk</span></span><br><span class="line"><span class="string">w</span>   <span class="string">write</span> <span class="string">table</span> <span class="string">to</span> <span class="string">disk</span> <span class="string">and</span> <span class="string">exit</span></span><br><span class="line"><span class="string">x</span>   <span class="string">extra</span> <span class="string">functionality</span> <span class="string">(experts</span> <span class="string">only)</span></span><br><span class="line"><span class="string">?</span>   <span class="string">print</span> <span class="string">this</span> <span class="string">menu</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">p</span>      <span class="string">&lt;==当前的分割情况</span></span><br><span class="line"><span class="attr">Disk /dev/sda:</span> <span class="number">419430400</span> <span class="string">sectors,</span> <span class="number">200.0</span> <span class="string">GiB</span></span><br><span class="line"><span class="attr">Logical sector size:</span> <span class="number">512</span> <span class="string">bytes</span></span><br><span class="line"><span class="string">Disk</span> <span class="string">identifier</span> <span class="string">(GUID):</span> <span class="string">A3D418CA-36F0-4B8F-9883-079D13FF5E56</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">table</span> <span class="string">holds</span> <span class="string">up</span> <span class="string">to</span> <span class="number">128</span> <span class="string">entries</span></span><br><span class="line"><span class="string">First</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">34</span><span class="string">,</span> <span class="string">last</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">419430366</span></span><br><span class="line"><span class="string">Partitions</span> <span class="string">will</span> <span class="string">be</span> <span class="string">aligned</span> <span class="string">on</span> <span class="number">2048</span><span class="string">-sector</span> <span class="string">boundaries</span></span><br><span class="line"><span class="string">Total</span> <span class="string">free</span> <span class="string">space</span> <span class="string">is</span> <span class="number">102748093</span> <span class="string">sectors</span> <span class="string">(49.0</span> <span class="string">GiB)</span></span><br><span class="line"></span><br><span class="line"><span class="string">Number</span>  <span class="string">Start</span> <span class="string">(sector)</span>    <span class="string">End</span> <span class="string">(sector)</span>  <span class="string">Size</span>       <span class="string">Code</span>  <span class="string">Name</span></span><br><span class="line">   <span class="number">1</span>            <span class="number">2048</span>            <span class="number">6143</span>   <span class="number">2.0</span> <span class="string">MiB</span>     <span class="string">EF02</span>  </span><br><span class="line">   <span class="number">2</span>            <span class="number">6144</span>         <span class="number">2103295</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">0700</span>  </span><br><span class="line">   <span class="number">3</span>         <span class="number">2103296</span>       <span class="number">316684287</span>   <span class="number">150.0</span> <span class="string">GiB</span>   <span class="number">8E00</span>  </span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">n</span>               <span class="comment">#新增一个</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">number</span> <span class="string">(4-128,</span> <span class="string">default</span> <span class="number">4</span><span class="string">):</span> <span class="number">4</span> <span class="comment">#直接enter,默认为4</span></span><br><span class="line"><span class="string">First</span> <span class="string">sector</span> <span class="string">(34-419430366,</span> <span class="string">default</span> <span class="string">=</span> <span class="number">316684288</span><span class="string">)</span> <span class="string">or</span> &#123;<span class="string">+-</span>&#125;<span class="string">size&#123;KMGTP&#125;:</span> <span class="number">316684288</span>   <span class="comment">#也可以直接enter</span></span><br><span class="line"><span class="string">Last</span> <span class="string">sector</span> <span class="string">(316684288-419430366,</span> <span class="string">default</span> <span class="string">=</span> <span class="number">419430366</span><span class="string">)</span> <span class="string">or</span> &#123;<span class="string">+-</span>&#125;<span class="string">size&#123;KMGTP&#125;:</span> <span class="string">+1G</span>  <span class="comment">#绝不要enter,而使用+1G这样,让gdisk自动计算sector</span></span><br><span class="line"><span class="string">Current</span> <span class="string">type</span> <span class="string">is</span> <span class="string">\&#x27;Linux</span> <span class="string">filesystem\&#x27;</span></span><br><span class="line"><span class="string">Hex</span> <span class="string">code</span> <span class="string">or</span> <span class="string">GUID</span> <span class="string">(L</span> <span class="string">to</span> <span class="string">show</span> <span class="string">codes,</span> <span class="string">Enter</span> <span class="string">=</span> <span class="number">8300</span><span class="string">):</span> <span class="comment">#选择扇区预计使用的文件系统,L查看所有</span></span><br><span class="line"><span class="string">Changed</span> <span class="string">type</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">to</span> <span class="string">\&#x27;Linux</span> <span class="string">filesystem\&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">p</span></span><br><span class="line"><span class="attr">Disk /dev/sda:</span> <span class="number">419430400</span> <span class="string">sectors,</span> <span class="number">200.0</span> <span class="string">GiB</span></span><br><span class="line"><span class="attr">Logical sector size:</span> <span class="number">512</span> <span class="string">bytes</span></span><br><span class="line"><span class="string">Disk</span> <span class="string">identifier</span> <span class="string">(GUID):</span> <span class="string">A3D418CA-36F0-4B8F-9883-079D13FF5E56</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">table</span> <span class="string">holds</span> <span class="string">up</span> <span class="string">to</span> <span class="number">128</span> <span class="string">entries</span></span><br><span class="line"><span class="string">First</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">34</span><span class="string">,</span> <span class="string">last</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">419430366</span></span><br><span class="line"><span class="string">Partitions</span> <span class="string">will</span> <span class="string">be</span> <span class="string">aligned</span> <span class="string">on</span> <span class="number">2048</span><span class="string">-sector</span> <span class="string">boundaries</span></span><br><span class="line"><span class="string">Total</span> <span class="string">free</span> <span class="string">space</span> <span class="string">is</span> <span class="number">100650941</span> <span class="string">sectors</span> <span class="string">(48.0</span> <span class="string">GiB)</span></span><br><span class="line"></span><br><span class="line"><span class="string">Number</span>  <span class="string">Start</span> <span class="string">(sector)</span>    <span class="string">End</span> <span class="string">(sector)</span>  <span class="string">Size</span>       <span class="string">Code</span>  <span class="string">Name</span></span><br><span class="line">   <span class="number">1</span>            <span class="number">2048</span>            <span class="number">6143</span>   <span class="number">2.0</span> <span class="string">MiB</span>     <span class="string">EF02</span>  </span><br><span class="line">   <span class="number">2</span>            <span class="number">6144</span>         <span class="number">2103295</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">0700</span>  </span><br><span class="line">   <span class="number">3</span>         <span class="number">2103296</span>       <span class="number">316684287</span>   <span class="number">150.0</span> <span class="string">GiB</span>   <span class="number">8E00</span>  </span><br><span class="line">   <span class="number">4</span>       <span class="number">316684288</span>       <span class="number">318781439</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">8300</span>  <span class="string">Linux</span> <span class="string">filesystem</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">n</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">number</span> <span class="string">(5-128,</span> <span class="string">default</span> <span class="number">5</span><span class="string">):</span> </span><br><span class="line"><span class="string">First</span> <span class="string">sector</span> <span class="string">(34-419430366,</span> <span class="string">default</span> <span class="string">=</span> <span class="number">318781440</span><span class="string">)</span> <span class="string">or</span> &#123;<span class="string">+-</span>&#125;<span class="string">size&#123;KMGTP&#125;:</span> </span><br><span class="line"><span class="string">Last</span> <span class="string">sector</span> <span class="string">(318781440-419430366,</span> <span class="string">default</span> <span class="string">=</span> <span class="number">419430366</span><span class="string">)</span> <span class="string">or</span> &#123;<span class="string">+-</span>&#125;<span class="string">size&#123;KMGTP&#125;:</span> <span class="string">+1G</span></span><br><span class="line"><span class="string">Current</span> <span class="string">type</span> <span class="string">is</span> <span class="string">\&#x27;Linux</span> <span class="string">filesystem\&#x27;</span></span><br><span class="line"><span class="string">Hex</span> <span class="string">code</span> <span class="string">or</span> <span class="string">GUID</span> <span class="string">(L</span> <span class="string">to</span> <span class="string">show</span> <span class="string">codes,</span> <span class="string">Enter</span> <span class="string">=</span> <span class="number">8300</span><span class="string">):</span> </span><br><span class="line"><span class="string">Changed</span> <span class="string">type</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">to</span> <span class="string">\&#x27;Linux</span> <span class="string">filesystem\&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">p</span></span><br><span class="line"><span class="attr">Disk /dev/sda:</span> <span class="number">419430400</span> <span class="string">sectors,</span> <span class="number">200.0</span> <span class="string">GiB</span></span><br><span class="line"><span class="attr">Logical sector size:</span> <span class="number">512</span> <span class="string">bytes</span></span><br><span class="line"><span class="string">Disk</span> <span class="string">identifier</span> <span class="string">(GUID):</span> <span class="string">A3D418CA-36F0-4B8F-9883-079D13FF5E56</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">table</span> <span class="string">holds</span> <span class="string">up</span> <span class="string">to</span> <span class="number">128</span> <span class="string">entries</span></span><br><span class="line"><span class="string">First</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">34</span><span class="string">,</span> <span class="string">last</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">419430366</span></span><br><span class="line"><span class="string">Partitions</span> <span class="string">will</span> <span class="string">be</span> <span class="string">aligned</span> <span class="string">on</span> <span class="number">2048</span><span class="string">-sector</span> <span class="string">boundaries</span></span><br><span class="line"><span class="string">Total</span> <span class="string">free</span> <span class="string">space</span> <span class="string">is</span> <span class="number">98553789</span> <span class="string">sectors</span> <span class="string">(47.0</span> <span class="string">GiB)</span></span><br><span class="line"></span><br><span class="line"><span class="string">Number</span>  <span class="string">Start</span> <span class="string">(sector)</span>    <span class="string">End</span> <span class="string">(sector)</span>  <span class="string">Size</span>       <span class="string">Code</span>  <span class="string">Name</span></span><br><span class="line">   <span class="number">1</span>            <span class="number">2048</span>            <span class="number">6143</span>   <span class="number">2.0</span> <span class="string">MiB</span>     <span class="string">EF02</span>  </span><br><span class="line">   <span class="number">2</span>            <span class="number">6144</span>         <span class="number">2103295</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">0700</span>  </span><br><span class="line">   <span class="number">3</span>         <span class="number">2103296</span>       <span class="number">316684287</span>   <span class="number">150.0</span> <span class="string">GiB</span>   <span class="number">8E00</span>  </span><br><span class="line">   <span class="number">4</span>       <span class="number">316684288</span>       <span class="number">318781439</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">8300</span>  <span class="string">Linux</span> <span class="string">filesystem</span></span><br><span class="line">   <span class="number">5</span>       <span class="number">318781440</span>       <span class="number">320878591</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">8300</span>  <span class="string">Linux</span> <span class="string">filesystem</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">?</span></span><br><span class="line"><span class="string">b</span>   <span class="string">back</span> <span class="string">up</span> <span class="string">GPT</span> <span class="string">data</span> <span class="string">to</span> <span class="string">a</span> <span class="string">file</span></span><br><span class="line"><span class="string">c</span>   <span class="string">change</span> <span class="string">a</span> <span class="string">partition\&#x27;s</span> <span class="string">name</span></span><br><span class="line"><span class="string">d</span>   <span class="string">delete</span> <span class="string">a</span> <span class="string">partition</span></span><br><span class="line"><span class="string">i</span>   <span class="string">show</span> <span class="string">detailed</span> <span class="string">information</span> <span class="string">on</span> <span class="string">a</span> <span class="string">partition</span></span><br><span class="line"><span class="string">l</span>   <span class="string">list</span> <span class="string">known</span> <span class="string">partition</span> <span class="string">types</span></span><br><span class="line"><span class="string">n</span>   <span class="string">add</span> <span class="string">a</span> <span class="string">new</span> <span class="string">partition</span></span><br><span class="line"><span class="string">o</span>   <span class="string">create</span> <span class="string">a</span> <span class="string">new</span> <span class="string">empty</span> <span class="string">GUID</span> <span class="string">partition</span> <span class="string">table</span> <span class="string">(GPT)</span></span><br><span class="line"><span class="string">p</span>   <span class="string">print</span> <span class="string">the</span> <span class="string">partition</span> <span class="string">table</span></span><br><span class="line"><span class="string">q</span>   <span class="string">quit</span> <span class="string">without</span> <span class="string">saving</span> <span class="string">changes</span></span><br><span class="line"><span class="string">r</span>   <span class="string">recovery</span> <span class="string">and</span> <span class="string">transformation</span> <span class="string">options</span> <span class="string">(experts</span> <span class="string">only)</span></span><br><span class="line"><span class="string">s</span>   <span class="string">sort</span> <span class="string">partitions</span></span><br><span class="line"><span class="string">t</span>   <span class="string">change</span> <span class="string">a</span> <span class="string">partition\&#x27;s</span> <span class="string">type</span> <span class="string">code</span></span><br><span class="line"><span class="string">v</span>   <span class="string">verify</span> <span class="string">disk</span></span><br><span class="line"><span class="string">w</span>   <span class="string">write</span> <span class="string">table</span> <span class="string">to</span> <span class="string">disk</span> <span class="string">and</span> <span class="string">exit</span></span><br><span class="line"><span class="string">x</span>   <span class="string">extra</span> <span class="string">functionality</span> <span class="string">(experts</span> <span class="string">only)</span></span><br><span class="line"><span class="string">?</span>   <span class="string">print</span> <span class="string">this</span> <span class="string">menu</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">d</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">number</span> <span class="string">(1-5):</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">p</span></span><br><span class="line"><span class="attr">Disk /dev/sda:</span> <span class="number">419430400</span> <span class="string">sectors,</span> <span class="number">200.0</span> <span class="string">GiB</span></span><br><span class="line"><span class="attr">Logical sector size:</span> <span class="number">512</span> <span class="string">bytes</span></span><br><span class="line"><span class="string">Disk</span> <span class="string">identifier</span> <span class="string">(GUID):</span> <span class="string">A3D418CA-36F0-4B8F-9883-079D13FF5E56</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">table</span> <span class="string">holds</span> <span class="string">up</span> <span class="string">to</span> <span class="number">128</span> <span class="string">entries</span></span><br><span class="line"><span class="string">First</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">34</span><span class="string">,</span> <span class="string">last</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">419430366</span></span><br><span class="line"><span class="string">Partitions</span> <span class="string">will</span> <span class="string">be</span> <span class="string">aligned</span> <span class="string">on</span> <span class="number">2048</span><span class="string">-sector</span> <span class="string">boundaries</span></span><br><span class="line"><span class="string">Total</span> <span class="string">free</span> <span class="string">space</span> <span class="string">is</span> <span class="number">100650941</span> <span class="string">sectors</span> <span class="string">(48.0</span> <span class="string">GiB)</span></span><br><span class="line"></span><br><span class="line"><span class="string">Number</span>  <span class="string">Start</span> <span class="string">(sector)</span>    <span class="string">End</span> <span class="string">(sector)</span>  <span class="string">Size</span>       <span class="string">Code</span>  <span class="string">Name</span></span><br><span class="line">   <span class="number">1</span>            <span class="number">2048</span>            <span class="number">6143</span>   <span class="number">2.0</span> <span class="string">MiB</span>     <span class="string">EF02</span>  </span><br><span class="line">   <span class="number">2</span>            <span class="number">6144</span>         <span class="number">2103295</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">0700</span>  </span><br><span class="line">   <span class="number">3</span>         <span class="number">2103296</span>       <span class="number">316684287</span>   <span class="number">150.0</span> <span class="string">GiB</span>   <span class="number">8E00</span>  </span><br><span class="line">   <span class="number">4</span>       <span class="number">316684288</span>       <span class="number">318781439</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">8300</span>  <span class="string">Linux</span> <span class="string">filesystem</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">n</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">number</span> <span class="string">(5-128,</span> <span class="string">default</span> <span class="number">5</span><span class="string">):</span> </span><br><span class="line"><span class="string">First</span> <span class="string">sector</span> <span class="string">(34-419430366,</span> <span class="string">default</span> <span class="string">=</span> <span class="number">318781440</span><span class="string">)</span> <span class="string">or</span> &#123;<span class="string">+-</span>&#125;<span class="string">size&#123;KMGTP&#125;:</span> </span><br><span class="line"><span class="string">Last</span> <span class="string">sector</span> <span class="string">(318781440-419430366,</span> <span class="string">default</span> <span class="string">=</span> <span class="number">419430366</span><span class="string">)</span> <span class="string">or</span> &#123;<span class="string">+-</span>&#125;<span class="string">size&#123;KMGTP&#125;:</span> <span class="string">+1G</span></span><br><span class="line"><span class="string">Current</span> <span class="string">type</span> <span class="string">is</span> <span class="string">\&#x27;Linux</span> <span class="string">filesystem\&#x27;</span></span><br><span class="line"><span class="string">Hex</span> <span class="string">code</span> <span class="string">or</span> <span class="string">GUID</span> <span class="string">(L</span> <span class="string">to</span> <span class="string">show</span> <span class="string">codes,</span> <span class="string">Enter</span> <span class="string">=</span> <span class="number">8300</span><span class="string">):</span> <span class="number">0700</span></span><br><span class="line"><span class="string">Changed</span> <span class="string">type</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">to</span> <span class="string">&#x27;Microsoft basic data&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">p</span></span><br><span class="line"><span class="attr">Disk /dev/sda:</span> <span class="number">419430400</span> <span class="string">sectors,</span> <span class="number">200.0</span> <span class="string">GiB</span></span><br><span class="line"><span class="attr">Logical sector size:</span> <span class="number">512</span> <span class="string">bytes</span></span><br><span class="line"><span class="string">Disk</span> <span class="string">identifier</span> <span class="string">(GUID):</span> <span class="string">A3D418CA-36F0-4B8F-9883-079D13FF5E56</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">table</span> <span class="string">holds</span> <span class="string">up</span> <span class="string">to</span> <span class="number">128</span> <span class="string">entries</span></span><br><span class="line"><span class="string">First</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">34</span><span class="string">,</span> <span class="string">last</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">419430366</span></span><br><span class="line"><span class="string">Partitions</span> <span class="string">will</span> <span class="string">be</span> <span class="string">aligned</span> <span class="string">on</span> <span class="number">2048</span><span class="string">-sector</span> <span class="string">boundaries</span></span><br><span class="line"><span class="string">Total</span> <span class="string">free</span> <span class="string">space</span> <span class="string">is</span> <span class="number">98553789</span> <span class="string">sectors</span> <span class="string">(47.0</span> <span class="string">GiB)</span></span><br><span class="line"></span><br><span class="line"><span class="string">Number</span>  <span class="string">Start</span> <span class="string">(sector)</span>    <span class="string">End</span> <span class="string">(sector)</span>  <span class="string">Size</span>       <span class="string">Code</span>  <span class="string">Name</span></span><br><span class="line">   <span class="number">1</span>            <span class="number">2048</span>            <span class="number">6143</span>   <span class="number">2.0</span> <span class="string">MiB</span>     <span class="string">EF02</span>  </span><br><span class="line">   <span class="number">2</span>            <span class="number">6144</span>         <span class="number">2103295</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">0700</span>  </span><br><span class="line">   <span class="number">3</span>         <span class="number">2103296</span>       <span class="number">316684287</span>   <span class="number">150.0</span> <span class="string">GiB</span>   <span class="number">8E00</span>  </span><br><span class="line">   <span class="number">4</span>       <span class="number">316684288</span>       <span class="number">318781439</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">8300</span>  <span class="string">Linux</span> <span class="string">filesystem</span></span><br><span class="line">   <span class="number">5</span>       <span class="number">318781440</span>       <span class="number">320878591</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">0700</span>  <span class="string">Microsoft</span> <span class="string">basic</span> <span class="string">data</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">n</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">number</span> <span class="string">(6-128,</span> <span class="string">default</span> <span class="number">6</span><span class="string">):</span> </span><br><span class="line"><span class="string">First</span> <span class="string">sector</span> <span class="string">(34-419430366,</span> <span class="string">default</span> <span class="string">=</span> <span class="number">320878592</span><span class="string">)</span> <span class="string">or</span> &#123;<span class="string">+-</span>&#125;<span class="string">size&#123;KMGTP&#125;:</span> </span><br><span class="line"><span class="string">Last</span> <span class="string">sector</span> <span class="string">(320878592-419430366,</span> <span class="string">default</span> <span class="string">=</span> <span class="number">419430366</span><span class="string">)</span> <span class="string">or</span> &#123;<span class="string">+-</span>&#125;<span class="string">size&#123;KMGTP&#125;:</span> <span class="string">+0.5G</span></span><br><span class="line"><span class="string">Current</span> <span class="string">type</span> <span class="string">is</span> <span class="string">&#x27;Linux filesystem&#x27;</span></span><br><span class="line"><span class="string">Hex</span> <span class="string">code</span> <span class="string">or</span> <span class="string">GUID</span> <span class="string">(L</span> <span class="string">to</span> <span class="string">show</span> <span class="string">codes,</span> <span class="string">Enter</span> <span class="string">=</span> <span class="number">8300</span><span class="string">):</span> <span class="string">l</span></span><br><span class="line"><span class="number">0700 </span><span class="string">Microsoft</span> <span class="string">basic</span> <span class="string">data</span>  <span class="string">0c01</span> <span class="string">Microsoft</span> <span class="string">reserved</span>    <span class="number">2700 </span><span class="string">Windows</span> <span class="string">RE</span>          </span><br><span class="line"><span class="number">4200 </span><span class="string">Windows</span> <span class="string">LDM</span> <span class="string">data</span>      <span class="number">4201 </span><span class="string">Windows</span> <span class="string">LDM</span> <span class="string">metadata</span>  <span class="number">7501 </span><span class="string">IBM</span> <span class="string">GPFS</span>            </span><br><span class="line"><span class="string">7f00</span> <span class="string">ChromeOS</span> <span class="string">kernel</span>       <span class="string">7f01</span> <span class="string">ChromeOS</span> <span class="string">root</span>         <span class="string">7f02</span> <span class="string">ChromeOS</span> <span class="string">reserved</span>   </span><br><span class="line"><span class="number">8200 </span><span class="string">Linux</span> <span class="string">swap</span>            <span class="number">8300 </span><span class="string">Linux</span> <span class="string">filesystem</span>      <span class="number">8301 </span><span class="string">Linux</span> <span class="string">reserved</span>      </span><br><span class="line"><span class="number">8e00</span> <span class="string">Linux</span> <span class="string">LVM</span>             <span class="string">a500</span> <span class="string">FreeBSD</span> <span class="string">disklabel</span>     <span class="string">a501</span> <span class="string">FreeBSD</span> <span class="string">boot</span>        </span><br><span class="line"><span class="string">a502</span> <span class="string">FreeBSD</span> <span class="string">swap</span>          <span class="string">a503</span> <span class="string">FreeBSD</span> <span class="string">UFS</span>           <span class="string">a504</span> <span class="string">FreeBSD</span> <span class="string">ZFS</span>         </span><br><span class="line"><span class="string">a505</span> <span class="string">FreeBSD</span> <span class="string">Vinum/RAID</span>    <span class="string">a580</span> <span class="string">Midnight</span> <span class="string">BSD</span> <span class="string">data</span>     <span class="string">a581</span> <span class="string">Midnight</span> <span class="string">BSD</span> <span class="string">boot</span>   </span><br><span class="line"><span class="string">a582</span> <span class="string">Midnight</span> <span class="string">BSD</span> <span class="string">swap</span>     <span class="string">a583</span> <span class="string">Midnight</span> <span class="string">BSD</span> <span class="string">UFS</span>      <span class="string">a584</span> <span class="string">Midnight</span> <span class="string">BSD</span> <span class="string">ZFS</span>    </span><br><span class="line"><span class="string">a585</span> <span class="string">Midnight</span> <span class="string">BSD</span> <span class="string">Vinum</span>    <span class="string">a800</span> <span class="string">Apple</span> <span class="string">UFS</span>             <span class="string">a901</span> <span class="string">NetBSD</span> <span class="string">swap</span>         </span><br><span class="line"><span class="string">a902</span> <span class="string">NetBSD</span> <span class="string">FFS</span>            <span class="string">a903</span> <span class="string">NetBSD</span> <span class="string">LFS</span>            <span class="string">a904</span> <span class="string">NetBSD</span> <span class="string">concatenated</span> </span><br><span class="line"><span class="string">a905</span> <span class="string">NetBSD</span> <span class="string">encrypted</span>      <span class="string">a906</span> <span class="string">NetBSD</span> <span class="string">RAID</span>           <span class="string">ab00</span> <span class="string">Apple</span> <span class="string">boot</span>          </span><br><span class="line"><span class="string">af00</span> <span class="string">Apple</span> <span class="string">HFS/HFS+</span>        <span class="string">af01</span> <span class="string">Apple</span> <span class="string">RAID</span>            <span class="string">af02</span> <span class="string">Apple</span> <span class="string">RAID</span> <span class="string">offline</span>  </span><br><span class="line"><span class="string">af03</span> <span class="string">Apple</span> <span class="string">label</span>           <span class="string">af04</span> <span class="string">AppleTV</span> <span class="string">recovery</span>      <span class="string">af05</span> <span class="string">Apple</span> <span class="string">Core</span> <span class="string">Storage</span>  </span><br><span class="line"><span class="string">be00</span> <span class="string">Solaris</span> <span class="string">boot</span>          <span class="string">bf00</span> <span class="string">Solaris</span> <span class="string">root</span>          <span class="string">bf01</span> <span class="string">Solaris</span> <span class="string">/usr</span> <span class="string">&amp;</span> <span class="string">Mac</span> <span class="string">Z</span></span><br><span class="line"><span class="string">bf02</span> <span class="string">Solaris</span> <span class="string">swap</span>          <span class="string">bf03</span> <span class="string">Solaris</span> <span class="string">backup</span>        <span class="string">bf04</span> <span class="string">Solaris</span> <span class="string">/var</span>        </span><br><span class="line"><span class="string">bf05</span> <span class="string">Solaris</span> <span class="string">/home</span>         <span class="string">bf06</span> <span class="string">Solaris</span> <span class="string">alternate</span> <span class="string">se</span>  <span class="string">bf07</span> <span class="string">Solaris</span> <span class="string">Reserved</span> <span class="number">1</span>  </span><br><span class="line"><span class="string">bf08</span> <span class="string">Solaris</span> <span class="string">Reserved</span> <span class="number">2</span>    <span class="string">bf09</span> <span class="string">Solaris</span> <span class="string">Reserved</span> <span class="number">3</span>    <span class="string">bf0a</span> <span class="string">Solaris</span> <span class="string">Reserved</span> <span class="number">4</span>  </span><br><span class="line"><span class="string">bf0b</span> <span class="string">Solaris</span> <span class="string">Reserved</span> <span class="number">5</span>    <span class="string">c001</span> <span class="string">HP-UX</span> <span class="string">data</span>            <span class="string">c002</span> <span class="string">HP-UX</span> <span class="string">service</span>       </span><br><span class="line"><span class="string">ed00</span> <span class="string">Sony</span> <span class="string">system</span> <span class="string">partitio</span>  <span class="string">ef00</span> <span class="string">EFI</span> <span class="string">System</span>            <span class="string">ef01</span> <span class="string">MBR</span> <span class="string">partition</span> <span class="string">scheme</span></span><br><span class="line"><span class="string">ef02</span> <span class="string">BIOS</span> <span class="string">boot</span> <span class="string">partition</span>   <span class="string">fb00</span> <span class="string">VMWare</span> <span class="string">VMFS</span>           <span class="string">fb01</span> <span class="string">VMWare</span> <span class="string">reserved</span>     </span><br><span class="line"><span class="string">fc00</span> <span class="string">VMWare</span> <span class="string">kcore</span> <span class="string">crash</span> <span class="string">p</span>  <span class="string">fd00</span> <span class="string">Linux</span> <span class="string">RAID</span>            </span><br><span class="line"><span class="string">Hex</span> <span class="string">code</span> <span class="string">or</span> <span class="string">GUID</span> <span class="string">(L</span> <span class="string">to</span> <span class="string">show</span> <span class="string">codes,</span> <span class="string">Enter</span> <span class="string">=</span> <span class="number">8300</span><span class="string">):</span> <span class="number">8200</span></span><br><span class="line"><span class="string">Changed</span> <span class="string">type</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">to</span> <span class="string">&#x27;Linux swap&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">p</span></span><br><span class="line"><span class="attr">Disk /dev/sda:</span> <span class="number">419430400</span> <span class="string">sectors,</span> <span class="number">200.0</span> <span class="string">GiB</span></span><br><span class="line"><span class="attr">Logical sector size:</span> <span class="number">512</span> <span class="string">bytes</span></span><br><span class="line"><span class="string">Disk</span> <span class="string">identifier</span> <span class="string">(GUID):</span> <span class="string">A3D418CA-36F0-4B8F-9883-079D13FF5E56</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">table</span> <span class="string">holds</span> <span class="string">up</span> <span class="string">to</span> <span class="number">128</span> <span class="string">entries</span></span><br><span class="line"><span class="string">First</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">34</span><span class="string">,</span> <span class="string">last</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">419430366</span></span><br><span class="line"><span class="string">Partitions</span> <span class="string">will</span> <span class="string">be</span> <span class="string">aligned</span> <span class="string">on</span> <span class="number">2048</span><span class="string">-sector</span> <span class="string">boundaries</span></span><br><span class="line"><span class="string">Total</span> <span class="string">free</span> <span class="string">space</span> <span class="string">is</span> <span class="number">2014 </span><span class="string">sectors</span> <span class="string">(1007.0</span> <span class="string">KiB)</span></span><br><span class="line"></span><br><span class="line"><span class="string">Number</span>  <span class="string">Start</span> <span class="string">(sector)</span>    <span class="string">End</span> <span class="string">(sector)</span>  <span class="string">Size</span>       <span class="string">Code</span>  <span class="string">Name</span></span><br><span class="line">   <span class="number">1</span>            <span class="number">2048</span>            <span class="number">6143</span>   <span class="number">2.0</span> <span class="string">MiB</span>     <span class="string">EF02</span>  </span><br><span class="line">   <span class="number">2</span>            <span class="number">6144</span>         <span class="number">2103295</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">0700</span>  </span><br><span class="line">   <span class="number">3</span>         <span class="number">2103296</span>       <span class="number">316684287</span>   <span class="number">150.0</span> <span class="string">GiB</span>   <span class="number">8E00</span>  </span><br><span class="line">   <span class="number">4</span>       <span class="number">316684288</span>       <span class="number">318781439</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">8300</span>  <span class="string">Linux</span> <span class="string">filesystem</span></span><br><span class="line">   <span class="number">5</span>       <span class="number">318781440</span>       <span class="number">320878591</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">0700</span>  <span class="string">Microsoft</span> <span class="string">basic</span> <span class="string">data</span></span><br><span class="line">   <span class="number">6</span>       <span class="number">320878592</span>       <span class="number">419430366</span>   <span class="number">47.0</span> <span class="string">GiB</span>    <span class="number">8200</span>  <span class="string">Linux</span> <span class="string">swap</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">d</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">number</span> <span class="string">(1-6):</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">n</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">number</span> <span class="string">(6-128,</span> <span class="string">default</span> <span class="number">6</span><span class="string">):</span> </span><br><span class="line"><span class="string">First</span> <span class="string">sector</span> <span class="string">(34-419430366,</span> <span class="string">default</span> <span class="string">=</span> <span class="number">320878592</span><span class="string">)</span> <span class="string">or</span> &#123;<span class="string">+-</span>&#125;<span class="string">size&#123;KMGTP&#125;:</span> </span><br><span class="line"><span class="string">Last</span> <span class="string">sector</span> <span class="string">(320878592-419430366,</span> <span class="string">default</span> <span class="string">=</span> <span class="number">419430366</span><span class="string">)</span> <span class="string">or</span> &#123;<span class="string">+-</span>&#125;<span class="string">size&#123;KMGTP&#125;:</span> <span class="string">+500M</span></span><br><span class="line"><span class="string">Current</span> <span class="string">type</span> <span class="string">is</span> <span class="string">&#x27;Linux filesystem&#x27;</span></span><br><span class="line"><span class="string">Hex</span> <span class="string">code</span> <span class="string">or</span> <span class="string">GUID</span> <span class="string">(L</span> <span class="string">to</span> <span class="string">show</span> <span class="string">codes,</span> <span class="string">Enter</span> <span class="string">=</span> <span class="number">8300</span><span class="string">):</span> <span class="number">8200</span></span><br><span class="line"><span class="string">Changed</span> <span class="string">type</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">to</span> <span class="string">&#x27;Linux swap&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">p</span></span><br><span class="line"><span class="attr">Disk /dev/sda:</span> <span class="number">419430400</span> <span class="string">sectors,</span> <span class="number">200.0</span> <span class="string">GiB</span></span><br><span class="line"><span class="attr">Logical sector size:</span> <span class="number">512</span> <span class="string">bytes</span></span><br><span class="line"><span class="string">Disk</span> <span class="string">identifier</span> <span class="string">(GUID):</span> <span class="string">A3D418CA-36F0-4B8F-9883-079D13FF5E56</span></span><br><span class="line"><span class="string">Partition</span> <span class="string">table</span> <span class="string">holds</span> <span class="string">up</span> <span class="string">to</span> <span class="number">128</span> <span class="string">entries</span></span><br><span class="line"><span class="string">First</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">34</span><span class="string">,</span> <span class="string">last</span> <span class="string">usable</span> <span class="string">sector</span> <span class="string">is</span> <span class="number">419430366</span></span><br><span class="line"><span class="string">Partitions</span> <span class="string">will</span> <span class="string">be</span> <span class="string">aligned</span> <span class="string">on</span> <span class="number">2048</span><span class="string">-sector</span> <span class="string">boundaries</span></span><br><span class="line"><span class="string">Total</span> <span class="string">free</span> <span class="string">space</span> <span class="string">is</span> <span class="number">97529789</span> <span class="string">sectors</span> <span class="string">(46.5</span> <span class="string">GiB)</span></span><br><span class="line"></span><br><span class="line"><span class="string">Number</span>  <span class="string">Start</span> <span class="string">(sector)</span>    <span class="string">End</span> <span class="string">(sector)</span>  <span class="string">Size</span>       <span class="string">Code</span>  <span class="string">Name</span></span><br><span class="line">   <span class="number">1</span>            <span class="number">2048</span>            <span class="number">6143</span>   <span class="number">2.0</span> <span class="string">MiB</span>     <span class="string">EF02</span>  </span><br><span class="line">   <span class="number">2</span>            <span class="number">6144</span>         <span class="number">2103295</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">0700</span>  </span><br><span class="line">   <span class="number">3</span>         <span class="number">2103296</span>       <span class="number">316684287</span>   <span class="number">150.0</span> <span class="string">GiB</span>   <span class="number">8E00</span>  </span><br><span class="line">   <span class="number">4</span>       <span class="number">316684288</span>       <span class="number">318781439</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">8300</span>  <span class="string">Linux</span> <span class="string">filesystem</span></span><br><span class="line">   <span class="number">5</span>       <span class="number">318781440</span>       <span class="number">320878591</span>   <span class="number">1024.0 </span><span class="string">MiB</span>  <span class="number">0700</span>  <span class="string">Microsoft</span> <span class="string">basic</span> <span class="string">data</span></span><br><span class="line">   <span class="number">6</span>       <span class="number">320878592</span>       <span class="number">321902591</span>   <span class="number">500.0</span> <span class="string">MiB</span>   <span class="number">8200</span>  <span class="string">Linux</span> <span class="string">swap</span></span><br><span class="line"></span><br><span class="line"><span class="string">Command</span> <span class="string">(?</span> <span class="string">for</span> <span class="string">help):</span> <span class="string">w</span></span><br><span class="line"></span><br><span class="line"><span class="string">Final</span> <span class="string">checks</span> <span class="string">complete.</span> <span class="string">About</span> <span class="string">to</span> <span class="string">write</span> <span class="string">GPT</span> <span class="string">data.</span> <span class="string">THIS</span> <span class="string">WILL</span> <span class="string">OVERWRITE</span> <span class="string">EXISTING</span></span><br><span class="line"><span class="string">PARTITIONS!!</span></span><br><span class="line"></span><br><span class="line"><span class="string">Do</span> <span class="string">you</span> <span class="string">want</span> <span class="string">to</span> <span class="string">proceed?</span> <span class="string">(Y/N):</span> <span class="string">y</span></span><br><span class="line"><span class="string">OK;</span> <span class="string">writing</span> <span class="string">new</span> <span class="string">GUID</span> <span class="string">partition</span> <span class="string">table</span> <span class="string">(GPT)</span> <span class="string">to</span> <span class="string">/dev/sda.</span></span><br><span class="line"><span class="attr">Warning:</span> <span class="string">The</span> <span class="string">kernel</span> <span class="string">is</span> <span class="string">still</span> <span class="string">using</span> <span class="string">the</span> <span class="string">old</span> <span class="string">partition</span> <span class="string">table.</span></span><br><span class="line"><span class="string">The</span> <span class="string">new</span> <span class="string">table</span> <span class="string">will</span> <span class="string">be</span> <span class="string">used</span> <span class="string">at</span> <span class="string">the</span> <span class="string">next</span> <span class="string">reboot.</span></span><br><span class="line"><span class="string">The</span> <span class="string">operation</span> <span class="string">has</span> <span class="string">completed</span> <span class="string">successfully.</span></span><br><span class="line"><span class="comment"># gdisk会警告可能出现的问题,按y确认,因为目前硬盘正在使用中,无法立即开始载入新的分割表</span></span><br><span class="line"></span><br><span class="line">[<span class="string">root@CentOS7</span> <span class="string">~</span>]<span class="comment"># cat /proc/partitions </span></span><br><span class="line"><span class="string">major</span> <span class="string">minor</span>  <span class="comment">#blocks  name</span></span><br><span class="line"></span><br><span class="line">  <span class="number">11</span>        <span class="number">0</span>      <span class="number">57978</span> <span class="string">sr0</span></span><br><span class="line">   <span class="number">8</span>        <span class="number">0</span>  <span class="number">209715200</span> <span class="string">sda</span></span><br><span class="line">   <span class="number">8</span>        <span class="number">1</span>       <span class="number">2048 </span><span class="string">sda1</span></span><br><span class="line">   <span class="number">8</span>        <span class="number">2</span>    <span class="number">1048576</span> <span class="string">sda2</span></span><br><span class="line">   <span class="number">8</span>        <span class="number">3</span>  <span class="number">157290496</span> <span class="string">sda3</span></span><br><span class="line"> <span class="number">253</span>        <span class="number">0</span>  <span class="number">104857600</span> <span class="string">dm-0</span></span><br><span class="line"> <span class="number">253</span>        <span class="number">1</span>    <span class="number">4194304</span> <span class="string">dm-1</span></span><br><span class="line"> <span class="number">253</span>        <span class="number">2</span>   <span class="number">20971520</span> <span class="string">dm-2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#并没有新的sda4,sda5,sda6,因为核心还没有更新,有两个方法可以更新</span></span><br><span class="line"><span class="number">1</span><span class="string">.重启</span></span><br><span class="line"><span class="number">2.</span><span class="string">partprobe来处理</span></span><br><span class="line"><span class="comment"># partprobe 更新Linux核心分割表资讯</span></span><br><span class="line"><span class="string">partprode</span> [<span class="string">-s</span>] <span class="string">可以不加s,屏幕不会出现任何信息</span></span><br><span class="line">[<span class="string">root@CentOS7</span> <span class="string">~</span>]<span class="comment"># partprobe -s</span></span><br><span class="line"><span class="string">/dev/sda:</span> <span class="string">gpt</span> <span class="string">partitions</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></span><br><span class="line">[<span class="string">root@CentOS7</span> <span class="string">~</span>]<span class="comment"># lsblk /dev/s</span></span><br><span class="line"><span class="string">/dev/sda</span>   <span class="string">/dev/sda1</span>  <span class="string">/dev/sda2</span>  <span class="string">/dev/sda3</span>  <span class="string">/dev/sda4</span>  <span class="string">/dev/sda5</span>  <span class="string">/dev/sda6</span>  <span class="string">/dev/sr0</span>   </span><br><span class="line">[<span class="string">root@CentOS7</span> <span class="string">~</span>]<span class="comment"># lsblk /dev/sda</span></span><br><span class="line"><span class="string">NAME</span>            <span class="string">MAJ:MIN</span> <span class="string">RM</span>  <span class="string">SIZE</span> <span class="string">RO</span> <span class="string">TYPE</span> <span class="string">MOUNTPOINT</span></span><br><span class="line"><span class="string">sda</span>               <span class="number">8</span><span class="string">:0</span>    <span class="number">0</span>  <span class="string">200G</span>  <span class="number">0</span> <span class="string">disk</span> </span><br><span class="line"><span class="string">├─sda1</span>            <span class="number">8</span><span class="string">:1</span>    <span class="number">0</span>    <span class="string">2M</span>  <span class="number">0</span> <span class="string">part</span> </span><br><span class="line"><span class="string">├─sda2</span>            <span class="number">8</span><span class="string">:2</span>    <span class="number">0</span>    <span class="string">1G</span>  <span class="number">0</span> <span class="string">part</span> <span class="string">/boot</span></span><br><span class="line"><span class="string">├─sda3</span>            <span class="number">8</span><span class="string">:3</span>    <span class="number">0</span>  <span class="string">150G</span>  <span class="number">0</span> <span class="string">part</span> </span><br><span class="line"><span class="string">│</span> <span class="string">├─centos-root</span> <span class="number">253</span><span class="string">:0</span>    <span class="number">0</span>  <span class="string">100G</span>  <span class="number">0</span> <span class="string">lvm</span>  <span class="string">/</span></span><br><span class="line"><span class="string">│</span> <span class="string">├─centos-swap</span> <span class="number">253</span><span class="string">:1</span>    <span class="number">0</span>    <span class="string">4G</span>  <span class="number">0</span> <span class="string">lvm</span>  [<span class="string">SWAP</span>]</span><br><span class="line"><span class="string">│</span> <span class="string">└─centos-home</span> <span class="number">253</span><span class="string">:2</span>    <span class="number">0</span>   <span class="string">20G</span>  <span class="number">0</span> <span class="string">lvm</span>  <span class="string">/home</span></span><br><span class="line"><span class="string">├─sda4</span>            <span class="number">8</span><span class="string">:4</span>    <span class="number">0</span>    <span class="string">1G</span>  <span class="number">0</span> <span class="string">part</span> </span><br><span class="line"><span class="string">├─sda5</span>            <span class="number">8</span><span class="string">:5</span>    <span class="number">0</span>    <span class="string">1G</span>  <span class="number">0</span> <span class="string">part</span> </span><br><span class="line"><span class="string">└─sda6</span>            <span class="number">8</span><span class="string">:6</span>    <span class="number">0</span>  <span class="string">500M</span>  <span class="number">0</span> <span class="string">part</span> </span><br><span class="line">[<span class="string">root@CentOS7</span> <span class="string">~</span>]<span class="comment"># cat /proc/partitions </span></span><br><span class="line"><span class="string">major</span> <span class="string">minor</span>  <span class="comment">#blocks  name</span></span><br><span class="line"></span><br><span class="line">  <span class="number">11</span>        <span class="number">0</span>      <span class="number">57978</span> <span class="string">sr0</span></span><br><span class="line">   <span class="number">8</span>        <span class="number">0</span>  <span class="number">209715200</span> <span class="string">sda</span></span><br><span class="line">   <span class="number">8</span>        <span class="number">1</span>       <span class="number">2048 </span><span class="string">sda1</span></span><br><span class="line">   <span class="number">8</span>        <span class="number">2</span>    <span class="number">1048576</span> <span class="string">sda2</span></span><br><span class="line">   <span class="number">8</span>        <span class="number">3</span>  <span class="number">157290496</span> <span class="string">sda3</span></span><br><span class="line">   <span class="number">8</span>        <span class="number">4</span>    <span class="number">1048576</span> <span class="string">sda4</span></span><br><span class="line">   <span class="number">8</span>        <span class="number">5</span>    <span class="number">1048576</span> <span class="string">sda5</span></span><br><span class="line">   <span class="number">8</span>        <span class="number">6</span>     <span class="number">512000</span> <span class="string">sda6</span></span><br><span class="line"> <span class="number">253</span>        <span class="number">0</span>  <span class="number">104857600</span> <span class="string">dm-0</span></span><br><span class="line"> <span class="number">253</span>        <span class="number">1</span>    <span class="number">4194304</span> <span class="string">dm-1</span></span><br><span class="line"> <span class="number">253</span>        <span class="number">2</span>   <span class="number">20971520</span> <span class="string">dm-2</span></span><br></pre></td></tr></table></figure>

<p>fdisk<br>fdisk跟gdisk的使用方式几乎一模一样,只是一个使用?作为提示资料,一个使用m作为提示资料</p>
<h3 id="硬盘格式化-建立文件系统"><a href="#硬盘格式化-建立文件系统" class="headerlink" title="硬盘格式化(建立文件系统)"></a>硬盘格式化(建立文件系统)</h3><h4 id="xfs文件系统mkfs-xfs"><a href="#xfs文件系统mkfs-xfs" class="headerlink" title="xfs文件系统mkfs.xfs"></a>xfs文件系统mkfs.xfs</h4><p>建立文件系统(make filesystem）</p>
<pre><code>命令:mkfs.xfs  mkfs.xfs [-b bsize] [-d parms] [-i parms] [-l parms] [-L label] [-f] [-r parms] 装置名称
选项和参数:
以下只要谈到数值,没有加单位表示bytes,可以用k,m,g,t,p(小写)等来解释,比较特殊的是s,它指的是sector的个数。
    -b 后面接block容量,可由512-64k,不过最大容量限制为Linux 的4k
    -d 后面接的是重要的data sction的相关参数值,主要有:
        agcount=数值 ：设定需要几个储存群组的意思(AG),通常与CPU有关
        asize=数值   : 每个AG设定为多少容量的意思,通常agcount/agsize只选一个设定即可
        file        : 指的是格式化的装置是个档案而不是个装置的意思
        size=数值        : data section 的容量,亦即你可以不将全部的装置容量用完的意思
        su=数值: 当有RAID时,那个stripe数值的意思,与下面的sw搭配使用
        sw=数值:  当有RAID时候,用于存储资料的磁碟数量(须扣除备份碟与备用碟)
        sunit=数值  :与su相当,不过单位使用的是几个sector(512 bytes大小)的意思
        swidth=数值  ：就是su*sw的数值,但是以几个sector(512 bytes大小)来设定
    -f  如果装置内已经有文件系统,则需要使用-f来强制格式化
    -i 与inode有关的设定,主要设定值有
        size=数值  ：最小是256bytes,最大是2k,一般256就足够了
        internal=[0|1] log装置如果为内置,默认1是内置,如果要用外部装置,使用写以下设定
        logdev=device log装置为后面接的装置,需设置internal为0
        size=数值    指定这块登录蛆的容量,通常最小也得512个block,大约2M以上才行
    -L 后面接这个文件系统的标题名称Label name的意思
    -r 指定realtime section的相关设置,常用有
        extsize=数值 ：就是那个extent数值,一般不需要设定,但有RAID时,最好设定与swidth的数值相同最好,最小伟4K最大为1G
</code></pre>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#格式化</span></span><br><span class="line">[root@CentOS7 ~]# mkfs.xfs /dev/sda4</span><br><span class="line"><span class="attribute">meta-data</span>=/dev/sda4              <span class="attribute">isize</span>=512    <span class="attribute">agcount</span>=4, <span class="attribute">agsize</span>=65536 blks</span><br><span class="line">         =                       <span class="attribute">sectsz</span>=512   <span class="attribute">attr</span>=2, <span class="attribute">projid32bit</span>=1</span><br><span class="line">         =                       <span class="attribute">crc</span>=1        <span class="attribute">finobt</span>=0, <span class="attribute">sparse</span>=0</span><br><span class="line">data     =                       <span class="attribute">bsize</span>=4096   <span class="attribute">blocks</span>=262144, <span class="attribute">imaxpct</span>=25</span><br><span class="line">         =                       <span class="attribute">sunit</span>=0      <span class="attribute">swidth</span>=0 blks</span><br><span class="line">naming   =version 2              <span class="attribute">bsize</span>=4096   <span class="attribute">ascii-ci</span>=0 <span class="attribute">ftype</span>=1</span><br><span class="line">log      =internal log           <span class="attribute">bsize</span>=4096   <span class="attribute">blocks</span>=2560, <span class="attribute">version</span>=2</span><br><span class="line">         =                       <span class="attribute">sectsz</span>=512   <span class="attribute">sunit</span>=0 blks, <span class="attribute">lazy-count</span>=1</span><br><span class="line">realtime =none                   <span class="attribute">extsz</span>=4096   <span class="attribute">blocks</span>=0, <span class="attribute">rtextents</span>=0</span><br><span class="line">[root@CentOS7 ~]# blkid /dev/sda4</span><br><span class="line">/dev/sda4: <span class="attribute">UUID</span>=<span class="string">&quot;f54b117c-7f37-434d-ba88-778074d9e1c4&quot;</span> <span class="attribute">TYPE</span>=<span class="string">&quot;xfs&quot;</span> <span class="attribute">PARTLABEL</span>=<span class="string">&quot;Linux filesystem&quot;</span> <span class="attribute">PARTUUID</span>=<span class="string">&quot;a49f2083-1abe-4c4a-89fe-9e62ab3e1f55&quot;</span></span><br><span class="line"><span class="comment"># 查看cpu数</span></span><br><span class="line">[root@CentOS7 ~]# grep <span class="string">&#x27;processor&#x27;</span> /proc/cpuinfo</span><br><span class="line">processor   : 0</span><br><span class="line">[root@CentOS7 ~]# mkfs.xfs -f -d <span class="attribute">agcount</span>=2 /dev/sda4</span><br><span class="line"><span class="attribute">meta-data</span>=/dev/sda4              <span class="attribute">isize</span>=512    <span class="attribute">agcount</span>=2, <span class="attribute">agsize</span>=131072 blks</span><br><span class="line">         =                       <span class="attribute">sectsz</span>=512   <span class="attribute">attr</span>=2, <span class="attribute">projid32bit</span>=1</span><br><span class="line">         =                       <span class="attribute">crc</span>=1        <span class="attribute">finobt</span>=0, <span class="attribute">sparse</span>=0</span><br><span class="line">data     =                       <span class="attribute">bsize</span>=4096   <span class="attribute">blocks</span>=262144, <span class="attribute">imaxpct</span>=25</span><br><span class="line">         =                       <span class="attribute">sunit</span>=0      <span class="attribute">swidth</span>=0 blks</span><br><span class="line">naming   =version 2              <span class="attribute">bsize</span>=4096   <span class="attribute">ascii-ci</span>=0 <span class="attribute">ftype</span>=1</span><br><span class="line">log      =internal log           <span class="attribute">bsize</span>=4096   <span class="attribute">blocks</span>=2560, <span class="attribute">version</span>=2</span><br><span class="line">         =                       <span class="attribute">sectsz</span>=512   <span class="attribute">sunit</span>=0 blks, <span class="attribute">lazy-count</span>=1</span><br><span class="line">realtime =none                   <span class="attribute">extsz</span>=4096   <span class="attribute">blocks</span>=0, <span class="attribute">rtextents</span>=0</span><br></pre></td></tr></table></figure>

<h4 id="xfs文件系统for-RAID性能优化"><a href="#xfs文件系统for-RAID性能优化" class="headerlink" title="xfs文件系统for RAID性能优化"></a>xfs文件系统for RAID性能优化</h4><p>&#x2F;&#x2F;todo 看完第14章后回来补充</p>
<h4 id="ext4文件系统mkfs-ext4"><a href="#ext4文件系统mkfs-ext4" class="headerlink" title="ext4文件系统mkfs.ext4"></a>ext4文件系统mkfs.ext4</h4><pre><code>命令:mkfs.ext4 [-b size] [-L label] 装置名称
选项和命令:
    -b 设置block的大小,有1k,2k,4k的容量
    -L 后面接装置的标头名称
</code></pre>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]<span class="comment"># mkfs.ext4 /dev/sda5</span></span><br><span class="line">mke2fs <span class="number">1.42</span>.<span class="number">9</span> (<span class="number">28</span>-Dec-<span class="number">2013</span>)</span><br><span class="line">文件系统标签=                             <span class="comment">#显示label name</span></span><br><span class="line">OS <span class="keyword">type</span>: Linux</span><br><span class="line">块大小=<span class="number">4096</span> (<span class="attr">log=</span><span class="number">2</span>)</span><br><span class="line">分块大小=<span class="number">4096</span> (<span class="attr">log=</span><span class="number">2</span>)</span><br><span class="line"><span class="attr">Stride=</span><span class="number">0</span> blocks, Stripe <span class="attr">width=</span><span class="number">0</span> blocks  <span class="comment">#跟RAID相关性较高</span></span><br><span class="line"><span class="number">65536</span> inodes, <span class="number">262144</span> blocks             <span class="comment">#总计inode/block数量</span></span><br><span class="line"><span class="number">13107</span> blocks (<span class="number">5.00</span>%) reserved for the super <span class="keyword">user</span></span><br><span class="line"><span class="title">第一个数据块=0</span></span><br><span class="line">Maximum filesystem <span class="attr">blocks=</span><span class="number">268435456</span></span><br><span class="line"><span class="number">8</span> block groups                          <span class="comment">#8个block groups</span></span><br><span class="line"><span class="number">32768</span> blocks per group, <span class="number">32768</span> fragments per <span class="keyword">group</span></span><br><span class="line"><span class="title">8192</span> inodes per <span class="keyword">group</span></span><br><span class="line"><span class="title">Superblock</span> backups stored on blocks:</span><br><span class="line">    <span class="number">32768</span>, <span class="number">98304</span>, <span class="number">163840</span>, <span class="number">229376</span></span><br><span class="line"></span><br><span class="line">Allocating <span class="keyword">group</span> <span class="title">tables</span>: 完成</span><br><span class="line">正在写入inode表: 完成</span><br><span class="line">Creating journal (<span class="number">8192</span> blocks): 完成</span><br><span class="line">Writing superblocks <span class="keyword">and</span> filesystem accounting <span class="literal">inf</span>ormation: 完成</span><br></pre></td></tr></table></figure>
<p>ext4的默认值已经相当适合我们使用,大部分的默认值写入于我们系统的&#x2F;etc&#x2F;mke2fs.conf这个文件</p>
<h4 id="其他文件系统mkfs"><a href="#其他文件系统mkfs" class="headerlink" title="其他文件系统mkfs"></a>其他文件系统mkfs</h4><p>mkfs其实是一个综合指令,当我们使用mkfs -t xfs时,它就会去找mkfs.xfs相关的参数。如果想要知道系统还支持哪些文件系统的格式化功能,直接按tab就知道了</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]<span class="comment"># mkfs</span></span><br><span class="line">mkfs         mkfs.cramfs  mkfs.ext3    mkfs.fat     mkfs.msdos   mkfs.xfs</span><br><span class="line">mkfs.btrfs   mkfs.ext2    mkfs.ext4    mkfs.minix   mkfs.vfat</span><br></pre></td></tr></table></figure>
<p>将sda5改为vfat格式</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]<span class="comment"># mkfs -t vfat /dev/sda5</span></span><br><span class="line">mkfs.fat 3.0.20 (12 Jun 2013)</span><br><span class="line">[root@CentOS7 ~]<span class="comment"># blkid /dev/sda5</span></span><br><span class="line">/dev/sda5: UUID=<span class="string">&quot;D5D7-EA49&quot;</span> TYPE=<span class="string">&quot;vfat&quot;</span> PARTLABEL=<span class="string">&quot;Microsoft basic data&quot;</span> PARTUUID=<span class="string">&quot;a1520dbf-ef3a-4794-b56d-d06a92c5b7f5&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="文件系统检验"><a href="#文件系统检验" class="headerlink" title="文件系统检验"></a>文件系统检验</h3><p>如果文件系统发生错乱,该如何挽救呢</p>
<h4 id="xfs-repair处理XFS文件系统"><a href="#xfs-repair处理XFS文件系统" class="headerlink" title="xfs_repair处理XFS文件系统"></a>xfs_repair处理XFS文件系统</h4><pre><code>命令: xfs_repair [-fnd] 装置名称
选项和参数:
     -f 后面的装置是个文件而不是实体装置
    -n 单纯检查并不修改文件系统的任何资料
    -d 通常用于单人维护模式下,针对根目录进行检查与修复的动作（慎用)
</code></pre>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查一下刚才的/dev/sda4文件系统</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># xfs_repair /dev/sda4</span></span><br><span class="line">Phase 1 - find<span class="built_in"> and </span>verify superblock...</span><br><span class="line">Phase 2 - using internal log</span><br><span class="line">        - zero log...</span><br><span class="line">        - scan filesystem freespace<span class="built_in"> and </span>inode maps...</span><br><span class="line">        - found root inode chunk</span><br><span class="line">Phase 3 - for each AG...</span><br><span class="line">        - scan<span class="built_in"> and </span>clear agi unlinked lists...</span><br><span class="line">        - process known inodes<span class="built_in"> and </span>perform inode discovery...</span><br><span class="line">        - agno = 0</span><br><span class="line">        - agno = 1</span><br><span class="line">        - process newly discovered inodes...</span><br><span class="line">Phase 4 -<span class="built_in"> check </span>for duplicate blocks...</span><br><span class="line">        - setting up duplicate extent list...</span><br><span class="line">        -<span class="built_in"> check </span>for inodes claiming duplicate blocks...</span><br><span class="line">        - agno = 0</span><br><span class="line">        - agno = 1</span><br><span class="line">Phase 5 - rebuild AG headers<span class="built_in"> and </span>trees...</span><br><span class="line">        - reset superblock...</span><br><span class="line">Phase 6 -<span class="built_in"> check </span>inode connectivity...</span><br><span class="line">        - resetting contents of realtime bitmap<span class="built_in"> and </span>summary inodes</span><br><span class="line">        - traversing filesystem ...</span><br><span class="line">        - traversal finished ...</span><br><span class="line">        - moving disconnected inodes to lost+found ...</span><br><span class="line">Phase 7 - verify<span class="built_in"> and </span>correct link counts...</span><br><span class="line">done</span><br><span class="line"><span class="comment">#检查原有的/dev/centos/home文件系统</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># xfs_repair /dev/centos/home</span></span><br><span class="line">xfs_repair: /dev/centos/home contains a mounted filesystem</span><br><span class="line">xfs_repair: /dev/centos/home contains a mounted<span class="built_in"> and </span>writable filesystem</span><br><span class="line"></span><br><span class="line">fatal error -- couldn&#x27;t initialize XFS library</span><br></pre></td></tr></table></figure>
<p>xfs_repair修复的文件系统不能被挂载</p>
<h4 id="fsck-ext4-处理EXT4文件系统"><a href="#fsck-ext4-处理EXT4文件系统" class="headerlink" title="fsck.ext4 处理EXT4文件系统"></a>fsck.ext4 处理EXT4文件系统</h4><pre><code>命令:fsck.ext4 [-pf] [-b superblock] 装置名称
选项和参数:
    -p 当档案系统在修复时候,若有需要回复y的动作,自动回复y来继续进行修复动作
    -f 强制检查!一般来说,如果fsck没有发现任何unclean的旗标,不会主动进入细部检查的,如果想要强制fsck进行细部检查,就得加上-f
    -D 针对文件系统下的目录进行最佳化配置
    -b 后面接superblock的位置,一般来说该选项用不到,但是你的superblock损坏时候,通过这个参数可以利用文件系统内备份的superblock来尝试救援,一般来说,superblock备份在:1k block放在8193,2k放在16384,4k放在32768
</code></pre>
<p>无论是xfs_repair或者fsck.ext4,只有root且文件系统有问题才使用这个命令<br>使用xfs_repair&#x2F;fsck.ext4,被检查的partition务必不能挂载到系统上,亦即是需要在卸载状态</p>
<h3 id="文件系统的挂载"><a href="#文件系统的挂载" class="headerlink" title="文件系统的挂载"></a>文件系统的挂载</h3><p>挂载前要先确定的几件事</p>
<ul>
<li><p>单一文件系统不应该被重复挂载在不同的挂载点</p>
</li>
<li><p>单一目录不应该重复挂载多个文件系统</p>
</li>
<li><p>要作为挂载点的目录,理论上应该都是空目录才是<br>如果原本挂载的目录不是空的,那么挂载了文件系统后,原目录下的东西会暂时消失.</p>
<p>  命令:mount -a<br>  mount [-l]<br>  mount [-t 文件系统] LABEL&#x3D;’’ 挂载点<br>  mount [-t 文件系统] UUID&#x3D;’’ 挂载点<br>  mount [-t 文件系统] 装置名称 挂载点<br>  选项和参数:<br>  -a 根据设置文件&#x2F;etc&#x2F;fstab 的资料将所有未挂载的硬盘都挂载上来<br>  -l 单纯的输入mount显示目前挂载信息 -l可以列出Label名称<br>  -t 可以加上文件系统种类来指定欲挂载的类型,常用的Linux支持系统有xfs、ext3、ext4，reiserfs、vfat、iso9660(光盘格式)、nfs、cifs、smbfs(后三种为网络文件系统类型)<br>  -n  ：在默认情况下,系统会将实际挂载的情况即时写入到&#x2F;etc&#x2F;mtab中，方便其他程序运行<br>      但在某些情況下(例如单人维护模式)为了避免问题会刻意不写入，此时就得使用-n选项<br>  -o  ：后面可以接一些挂载时額外加上的参数！比如说账号、密码、读写权限等<br>          async, sync:   此文件系统是否使用同步写入或异步写入的内存机制,默认async<br>          atime,noatime: 是否修改文件的读取时间(atime)。为了性能某些情况可以使用 noatime<br>          ro, rw:        挂载文件系统为只读或可读写<br>          auto, noauto:  允许此 filesystem 被以 mount -a 自动挂载(auto)<br>          dev, nodev:    是否允许此 filesystem 上，可建立裝置文件？ dev为可允许<br>          suid, nosuid:  是否允许此 filesystem 含有 suid&#x2F;sgid 的文件格式？<br>          exec, noexec:  是否允许此 filesystem 上拥有可执行binary 文件？<br>          user, nouser:  是否允许此 filesystem 让任何使用者执行 mount ？一般来说，mount 只有 root 可以运行，但下达 user 参数，则可以让一般user也能够对此partition进行mount<br>          defaults:      默认值为：rw, suid, dev, exec, auto, nouser, and async<br>          remount:       重新挂载，在系统出错，或重新更新参数时，很有用</p>
</li>
</ul>
<p>系统有哪些类型的filesystem需要进行上述的挂载测试，主要是参考下面的两个档案:<br>&#x2F;etc&#x2F;filesystems:系统指定的测试挂载文件系统类型的优先顺序<br>&#x2F;proc&#x2F;filesystems:Linux系统已经载入的文件系统类型<br>Linux支持的文件系统之驱动程序写在如下的目录</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/lib/m</span>odules<span class="regexp">/$(uname -r)/</span>kernel<span class="regexp">/fs/</span></span><br></pre></td></tr></table></figure>

<h4 id="挂载xfs-x2F-ext4-x2F-vfat等文件系统"><a href="#挂载xfs-x2F-ext4-x2F-vfat等文件系统" class="headerlink" title="挂载xfs&#x2F;ext4&#x2F;vfat等文件系统"></a>挂载xfs&#x2F;ext4&#x2F;vfat等文件系统</h4><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]# mkdir -p <span class="regexp">/data/</span>xfs</span><br><span class="line">[root@CentOS7 ~]# mkdir <span class="regexp">/data/</span>ext4</span><br><span class="line">[root@CentOS7 ~]# blkid <span class="regexp">/dev/</span>sda4 <span class="regexp">/dev/</span>sda5</span><br><span class="line"><span class="regexp">/dev/</span>sda4: UUID=<span class="string">&quot;4df71d00-09c9-470e-a5d2-d97522846502&quot;</span> TYPE=<span class="string">&quot;xfs&quot;</span> PARTLABEL=<span class="string">&quot;Linux filesystem&quot;</span> PARTUUID=<span class="string">&quot;924f2469-6cf0-4fd2-9952-84f3f8908443&quot;</span> </span><br><span class="line"><span class="regexp">/dev/</span>sda5: UUID=<span class="string">&quot;daaa9a30-6731-4854-a8b1-82bc6632f329&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span> PARTLABEL=<span class="string">&quot;Microsoft basic data&quot;</span> PARTUUID=<span class="string">&quot;6efa3641-c5ad-4d23-88e1-969d972262ac&quot;</span> </span><br><span class="line">[root@CentOS7 ~]# mount UUID=<span class="string">&quot;4df71d00-09c9-470e-a5d2-d97522846502&quot;</span> <span class="regexp">/data/</span>xfs   #挂载xfs</span><br><span class="line">[root@CentOS7 ~]# mount UUID=<span class="string">&quot;daaa9a30-6731-4854-a8b1-82bc6632f329&quot;</span> <span class="regexp">/data/</span>ext4   #挂载ext4</span><br><span class="line">[root@CentOS7 ~]# df <span class="regexp">/data/</span>xfs<span class="regexp">/ /</span>data<span class="regexp">/ext4/</span></span><br><span class="line">文件系统         <span class="number">1</span>K-块  已用    可用 已用% 挂载点</span><br><span class="line"><span class="regexp">/dev/</span>sda4      <span class="number">1038336</span> <span class="number">32880</span> <span class="number">1005456</span>    <span class="number">4</span>% <span class="regexp">/data/</span>xfs</span><br><span class="line"><span class="regexp">/dev/</span>sda5       <span class="number">999320</span>  <span class="number">2564</span>  <span class="number">927944</span>    <span class="number">1</span>% <span class="regexp">/data/</span>ext4</span><br></pre></td></tr></table></figure>

<h4 id="挂载光盘"><a href="#挂载光盘" class="headerlink" title="挂载光盘"></a>挂载光盘</h4><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]# blkid</span><br><span class="line"><span class="regexp">/dev/</span>sr0: UUID=<span class="string">&quot;2016-12-05-13-52-39-00&quot;</span> LABEL=<span class="string">&quot;CentOS 7 x86_64&quot;</span> TYPE=<span class="string">&quot;iso9660&quot;</span> PTTYPE=<span class="string">&quot;dos&quot;</span> </span><br><span class="line"><span class="regexp">/dev/</span>sda1: PARTUUID=<span class="string">&quot;42925040-87b8-45c8-8c8b-7361607e93cf&quot;</span> </span><br><span class="line"><span class="regexp">/dev/</span>sda2: UUID=<span class="string">&quot;87fdbc5c-2b5d-4f09-b26c-88bdcd4d2144&quot;</span> TYPE=<span class="string">&quot;xfs&quot;</span> PARTUUID=<span class="string">&quot;db746d09-3d43-46ca-a610-ee06c35f55ba&quot;</span> </span><br><span class="line"><span class="regexp">/dev/</span>sda3: UUID=<span class="string">&quot;dEe2aq-ytWb-BSQu-J4Ui-Yx0x-ilrn-FKk0IN&quot;</span> TYPE=<span class="string">&quot;LVM2_member&quot;</span> PARTUUID=<span class="string">&quot;3c7cab64-d98b-4453-9600-6c9a75bc6efc&quot;</span> </span><br><span class="line"><span class="regexp">/dev/</span>sda4: UUID=<span class="string">&quot;4df71d00-09c9-470e-a5d2-d97522846502&quot;</span> TYPE=<span class="string">&quot;xfs&quot;</span> PARTLABEL=<span class="string">&quot;Linux filesystem&quot;</span> PARTUUID=<span class="string">&quot;924f2469-6cf0-4fd2-9952-84f3f8908443&quot;</span> </span><br><span class="line"><span class="regexp">/dev/</span>sda5: UUID=<span class="string">&quot;daaa9a30-6731-4854-a8b1-82bc6632f329&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span> PARTLABEL=<span class="string">&quot;Microsoft basic data&quot;</span> PARTUUID=<span class="string">&quot;6efa3641-c5ad-4d23-88e1-969d972262ac&quot;</span> </span><br><span class="line"><span class="regexp">/dev/m</span>apper/centos-root: UUID=<span class="string">&quot;dd92edb9-26bb-4fa3-965d-4ae98dfbe040&quot;</span> TYPE=<span class="string">&quot;xfs&quot;</span> </span><br><span class="line"><span class="regexp">/dev/m</span>apper/centos-swap: UUID=<span class="string">&quot;0c06f7c6-265d-4672-8ba3-32b045e22ee4&quot;</span> TYPE=<span class="string">&quot;swap&quot;</span> </span><br><span class="line"><span class="regexp">/dev/m</span>apper/centos-home: UUID=<span class="string">&quot;e033015e-1048-4c23-bbca-0536e6f326ec&quot;</span> TYPE=<span class="string">&quot;xfs&quot;</span> </span><br><span class="line">[root@CentOS7 ~]# mkdir <span class="regexp">/data/</span>cdrom</span><br><span class="line">[root@CentOS7 ~]# mount <span class="regexp">/dev/</span>sr0 <span class="regexp">/data/</span>cdrom</span><br><span class="line">mount: <span class="regexp">/dev/</span>sr0 写保护，将以只读方式挂载</span><br><span class="line">[root@CentOS7 ~]# df <span class="regexp">/data/</span>cdrom/</span><br><span class="line">文件系统         <span class="number">1</span>K-块    已用  可用 已用% 挂载点</span><br><span class="line"><span class="regexp">/dev/</span>sr0       <span class="number">8086368</span> <span class="number">8086368</span>     <span class="number">0</span>  <span class="number">100</span>% <span class="regexp">/data/</span>cdrom</span><br></pre></td></tr></table></figure>

<h4 id="挂载vfatU盘"><a href="#挂载vfatU盘" class="headerlink" title="挂载vfatU盘"></a>挂载vfatU盘</h4><p>这里我复制的鸟哥的例子</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@study ~]# blkid</span><br><span class="line"><span class="regexp">/dev/</span>sda1: UUID=<span class="string">&quot;35BC-6D6B&quot;</span> TYPE=<span class="string">&quot;vfat&quot;</span></span><br><span class="line"></span><br><span class="line">[root@study ~]# mkdir <span class="regexp">/data/u</span>sb</span><br><span class="line">[root@study ~]#   mount -o codepage=<span class="number">950</span>,iocharset=utf8 UUID=<span class="string">&quot;35BC-6D6B&quot;</span> <span class="regexp">/data/u</span>sb</span><br><span class="line">[root@study ~]# # mount -o codepage=<span class="number">950</span>,iocharset=big5 UUID=<span class="string">&quot;35BC-6D6B&quot;</span> <span class="regexp">/data/u</span>sb</span><br><span class="line">[root@study ~]# df <span class="regexp">/data/u</span>sb</span><br><span class="line">Filesystem     <span class="number">1</span>K-blocks  Used Available Use% Mounted on</span><br><span class="line"><span class="regexp">/dev/</span>sda1        <span class="number">2092344</span>     <span class="number">4</span>   <span class="number">2092340</span>   <span class="number">1</span>% <span class="regexp">/data/u</span>sb</span><br></pre></td></tr></table></figure>
<p>如果带有中文文件名的资料,那么可以在挂载时候指定一下挂载文件系统所使用的语系资料。man mount 中可以找到语系资料。</p>
<h4 id="重新挂载根目录"><a href="#重新挂载根目录" class="headerlink" title="重新挂载根目录"></a>重新挂载根目录</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#重新挂载根目录,并加入参数为rw与<span class="built_in">auto</span></span><br><span class="line">mount -o remount,rw,<span class="built_in">auto</span> /</span><br></pre></td></tr></table></figure>
<h4 id="挂载不特定目录"><a href="#挂载不特定目录" class="headerlink" title="挂载不特定目录"></a>挂载不特定目录</h4><p>虽然可以用软链接来链接目标，但是有些不支持软链接的程序运行中，就需要这种方法了</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]# mkdir <span class="regexp">/data/</span>var</span><br><span class="line">[root@CentOS7 ~]# mount --bind <span class="regexp">/var/</span> <span class="regexp">/data/</span>var</span><br><span class="line">[root@CentOS7 ~]# ll -di <span class="regexp">/var /</span>data/var</span><br><span class="line"><span class="number">69</span> drwxr-xr-x. <span class="number">20</span> root root <span class="number">282</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">09</span>:<span class="number">45</span> <span class="regexp">/data/</span>var</span><br><span class="line"><span class="number">69</span> drwxr-xr-x. <span class="number">20</span> root root <span class="number">282</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">09</span>:<span class="number">45</span> /var</span><br><span class="line">[root@CentOS7 ~]# mount | <span class="keyword">grep</span> var</span><br><span class="line">sunrpc on <span class="regexp">/var/</span>lib<span class="regexp">/nfs/</span>rpc_pipefs type rpc_pipefs (rw,relatime)</span><br><span class="line"><span class="regexp">/dev/m</span>apper<span class="regexp">/centos-root on /</span>data/var type xfs (rw,relatime,seclabel,attr2,inode64,noquota)</span><br></pre></td></tr></table></figure>

<h4 id="umount-卸载装置文件"><a href="#umount-卸载装置文件" class="headerlink" title="umount(卸载装置文件)"></a>umount(卸载装置文件)</h4><pre><code>命令:umount [-fn] 装置文件名或挂载点
选项和参数:
    -f 强制卸载，可用在网络文件系统无法读取的情况
    -l 立即卸载,比-f还强
    -n 不更新/etc/mtab情况下卸载
</code></pre>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>CentOS7 <span class="keyword">data</span>]# umount /dev/sda4</span><br><span class="line">[<span class="symbol">root@</span>CentOS7 <span class="keyword">data</span>]# umount /dev/sda5</span><br><span class="line">[<span class="symbol">root@</span>CentOS7 <span class="keyword">data</span>]# umount /dev/cdrom</span><br><span class="line">[<span class="symbol">root@</span>CentOS7 <span class="keyword">data</span>]# umount /<span class="keyword">data</span>/cdrom</span><br><span class="line">[<span class="symbol">root@</span>CentOS7 <span class="keyword">data</span>]# umount /<span class="keyword">data</span>/<span class="keyword">var</span></span><br></pre></td></tr></table></figure>

<h3 id="硬盘-x2F-文件系统参数修改"><a href="#硬盘-x2F-文件系统参数修改" class="headerlink" title="硬盘&#x2F;文件系统参数修改"></a>硬盘&#x2F;文件系统参数修改</h3><h4 id="mknod"><a href="#mknod" class="headerlink" title="mknod"></a>mknod</h4><p>Linxu下的文件如何代表装置:<br>通过文件的major与minor数值来代替</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 data]<span class="comment"># ll /dev/sda*</span></span><br><span class="line">brw-rw----.<span class="number"> 1 </span>root disk 8,<span class="number"> 0 </span>3月  <span class="number"> 7 </span>09:45 /dev/sda</span><br><span class="line">brw-rw----.<span class="number"> 1 </span>root disk 8,<span class="number"> 1 </span>3月  <span class="number"> 7 </span>09:45 /dev/sda1</span><br><span class="line">brw-rw----.<span class="number"> 1 </span>root disk 8,<span class="number"> 2 </span>3月  <span class="number"> 7 </span>09:45 /dev/sda2</span><br><span class="line">brw-rw----.<span class="number"> 1 </span>root disk 8,<span class="number"> 3 </span>3月  <span class="number"> 7 </span>09:45 /dev/sda3</span><br><span class="line">brw-rw----.<span class="number"> 1 </span>root disk 8,<span class="number"> 4 </span>3月  <span class="number"> 7 </span>09:45 /dev/sda4</span><br><span class="line">brw-rw----.<span class="number"> 1 </span>root disk 8,<span class="number"> 5 </span>3月  <span class="number"> 7 </span>09:45 /dev/sda5</span><br></pre></td></tr></table></figure>
<p>8为主要装置代码(Major)而0-5为次要装置代码(Minor)，常用的硬盘文件名&#x2F;dev&#x2F;sda与&#x2F;dev&#x2F;loop0装置代码:</p>
<table>
<thead>
<tr>
<th>硬盘文件名</th>
<th align="center">Major</th>
<th align="right">Minor</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;dev&#x2F;sda</td>
<td align="center">8</td>
<td align="right">0-15</td>
</tr>
<tr>
<td>&#x2F;dev&#x2F;sdb</td>
<td align="center">8</td>
<td align="right">16-31</td>
</tr>
<tr>
<td>&#x2F;dev&#x2F;loop0</td>
<td align="center">7</td>
<td align="right">0</td>
</tr>
<tr>
<td>&#x2F;dev&#x2F;loop1</td>
<td align="center">7</td>
<td align="right">1</td>
</tr>
</tbody></table>
<pre><code>命令: mknod 裝置文件名 [bcp] [Major] [Minor]
选项和参数:
装置类型:
     b 设定装置名称成为一个周边储存设备文件,例如硬盘等
     c 设定装置名称成为一个周边输入设备文件,例如键盘/鼠标
     p 设定装置名称成为一个FIFO文件
Major 主要装置代码
Minor 次要装置代码
</code></pre>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#根据上面,我们知道<span class="regexp">/dev/</span>sda10装置代码为<span class="number">8</span> <span class="number">10</span></span><br><span class="line">[root@CentOS7 data]# mknod <span class="regexp">/dev/</span>sda10 b <span class="number">8</span> <span class="number">10</span></span><br><span class="line">[root@CentOS7 data]# ll <span class="regexp">/dev/</span>s</span><br><span class="line">sda       sda10     sda3      sda5      sg1       snapshot  sr0       stdin     </span><br><span class="line">sda1      sda2      sda4      sg0       shm<span class="regexp">/      snd/</span>      stderr    stdout    </span><br><span class="line">[root@CentOS7 data]# ll <span class="regexp">/dev/</span>sda10</span><br><span class="line">brw-r--r--. <span class="number">1</span> root root <span class="number">8</span>, <span class="number">10</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">10</span>:<span class="number">27</span> <span class="regexp">/dev/</span>sda10</span><br><span class="line">#建立一个FIFO文件</span><br><span class="line">[root@CentOS7 data]# mknod <span class="regexp">/tmp/</span>testpipe p</span><br><span class="line">[root@CentOS7 data]# ll <span class="regexp">/tmp/</span>testpipe </span><br><span class="line">prw-r--r--. <span class="number">1</span> root root <span class="number">0</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">10</span>:<span class="number">27</span> <span class="regexp">/tmp/</span>testpipe</span><br></pre></td></tr></table></figure>

<h4 id="xfs-admin-修改xfs文件系统的UUID与Label-name"><a href="#xfs-admin-修改xfs文件系统的UUID与Label-name" class="headerlink" title="xfs_admin 修改xfs文件系统的UUID与Label name"></a>xfs_admin 修改xfs文件系统的UUID与Label name</h4><pre><code>命令:xfs_admin [-lu] [-L label] [-U uuid] 装置文件名
选项和参数:
    -l 列出这个装置的Label name
    -u 列出这个装置的UUID
    -L 设置这个装置的Label name
    -U 设置这个装置的UUID
</code></pre>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#设置<span class="regexp">/dev/</span>sda4的label name为haokaiyang_xfs，并挂载</span><br><span class="line">[root@CentOS7 ~]# xfs_admin -L haokaiyang_xfs <span class="regexp">/dev/</span>sda4</span><br><span class="line">writing all SBs</span><br><span class="line">xfs_admin: truncating label length <span class="keyword">from</span> <span class="number">14</span> to <span class="number">12</span>           #haokaiyang_xfs超出了限制</span><br><span class="line"><span class="keyword">new</span> label = <span class="string">&quot;haokaiyang_x&quot;</span></span><br><span class="line">[root@CentOS7 ~]# mount LABEL=haokaiyang_x <span class="regexp">/data/</span>xfs</span><br><span class="line">[root@CentOS7 ~]# df <span class="regexp">/data/</span>xfs</span><br><span class="line">文件系统         <span class="number">1</span>K-块  已用    可用 已用% 挂载点</span><br><span class="line"><span class="regexp">/dev/</span>sda4      <span class="number">1038336</span> <span class="number">32880</span> <span class="number">1005456</span>    <span class="number">4</span>% <span class="regexp">/data/</span>xfs</span><br><span class="line">#利用uuidgen产生新UUID来设置<span class="regexp">/dev/</span>sda4，并挂载</span><br><span class="line">[root@CentOS7 ~]# umount <span class="regexp">/dev/</span>sda4</span><br><span class="line">[root@CentOS7 ~]# uuidgen</span><br><span class="line">f50beef2-<span class="number">2</span>ee9-<span class="number">4400</span>-<span class="number">9027</span>-<span class="number">2</span>ebf71c90e00</span><br><span class="line">[root@CentOS7 ~]# xfs_admin -u <span class="regexp">/dev/</span>sda4</span><br><span class="line">UUID = <span class="number">4</span>df71d00-<span class="number">09</span>c9-<span class="number">470</span>e-a5d2-d97522846502</span><br><span class="line">[root@CentOS7 ~]# xfs_admin -U f50beef2-<span class="number">2</span>ee9-<span class="number">4400</span>-<span class="number">9027</span>-<span class="number">2</span>ebf71c90e00 <span class="regexp">/dev/</span>s</span><br><span class="line">sda       sda2      sda4      sg0       shm<span class="regexp">/      snd/</span>      stderr    stdout    </span><br><span class="line">sda1      sda3      sda5      sg1       snapshot  sr0       stdin     </span><br><span class="line">[root@CentOS7 ~]# xfs_admin -U f50beef2-<span class="number">2</span>ee9-<span class="number">4400</span>-<span class="number">9027</span>-<span class="number">2</span>ebf71c90e00 <span class="regexp">/dev/</span>sda4</span><br><span class="line">Clearing log and setting UUID</span><br><span class="line">writing all SBs</span><br><span class="line"><span class="keyword">new</span> UUID = f50beef2-<span class="number">2</span>ee9-<span class="number">4400</span>-<span class="number">9027</span>-<span class="number">2</span>ebf71c90e00</span><br><span class="line">[root@CentOS7 ~]# mount UUID=f50beef2-<span class="number">2</span>ee9-<span class="number">4400</span>-<span class="number">9027</span>-<span class="number">2</span>ebf71c90e00 <span class="regexp">/data/</span>xfs</span><br><span class="line">[root@CentOS7 ~]# df <span class="regexp">/data/</span>xfs</span><br><span class="line">文件系统         <span class="number">1</span>K-块  已用    可用 已用% 挂载点</span><br><span class="line"><span class="regexp">/dev/</span>sda4      <span class="number">1038336</span> <span class="number">32880</span> <span class="number">1005456</span>    <span class="number">4</span>% <span class="regexp">/data/</span>xfs</span><br></pre></td></tr></table></figure>

<h4 id="tune2fs-修改ext4的label-name-与UUID"><a href="#tune2fs-修改ext4的label-name-与UUID" class="headerlink" title="tune2fs 修改ext4的label name 与UUID"></a>tune2fs 修改ext4的label name 与UUID</h4><pre><code>命令:tune2fs [-l] [-L Label] [-U uuid] 装置文件名
选项和参数:
    -l 类似dump2fs -h 的功能,将superblock内资料列出来
    -L 修改label name
    -U 修改UUID
</code></pre>
<h2 id="开机挂载"><a href="#开机挂载" class="headerlink" title="开机挂载"></a>开机挂载</h2><p>系统挂载的一些限制:</p>
<ul>
<li>根目录必须挂载,而且一定要先于其他mount point 挂载进来</li>
<li>其它mount point 必须为已建立的目录，可任意指定，但要遵守FHS</li>
<li>所有mount point 在同一时间之内,只能挂载一次</li>
<li>所有partition在同一时间内，只能挂载一次</li>
<li>如果进行卸载,您必须先将工作目录转移到mount point(及其子目录)之外</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]<span class="comment"># cat /etc/fstab</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Mon Feb 27 17:00:32 2017</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="regexp">/dev/m</span>apper<span class="regexp">/centos-root /</span>                       xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">UUID=<span class="number">87</span>fdbc5c-<span class="number">2</span>b5d-<span class="number">4</span>f09-b26c-<span class="number">88</span>bdcd4d2144 /boot                   xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="regexp">/dev/m</span>apper<span class="regexp">/centos-home /</span>home                   xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="regexp">/dev/m</span>apper/centos-swap swap                    swap    defaults        <span class="number">0</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>六个栏位为</p>
<p>[装置&#x2F;UUID等]  [挂载点]  [文件系统]  [文件系统参数]  [dump]  [fsck]</p>
<p>第一栏:硬盘装置文件名&#x2F;UUID&#x2F;label name<br>这个栏位可以填写的资料有三个</p>
<ul>
<li>文件系统或硬盘的装置文件名 如&#x2F;dev&#x2F;sda2等</li>
<li>文件系统的UUID名称,如UUID&#x3D;xxx</li>
<li>文件系统的LABEL名称,如LABEL&#x3D;xxx<br>第二栏:挂载点<br>第三栏:文件系统类型<br>第四栏:文件系统参数<br>和mount的特殊参数一样</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th align="center">内容意义</th>
</tr>
</thead>
<tbody><tr>
<td>async&#x2F;sync</td>
<td align="center">此文件系统是否使用同步写入或异步写入的内存机制,默认async</td>
</tr>
<tr>
<td>auto&#x2F;noauto</td>
<td align="center">允许此 filesystem 被以 mount -a 自动挂载(auto)，默认auto</td>
</tr>
<tr>
<td>rw&#x2F;ro</td>
<td align="center">挂载文件系统为只读或可读写</td>
</tr>
<tr>
<td>exec&#x2F;noexec</td>
<td align="center">是否允许此 filesystem 上拥有可执行binary 文件</td>
</tr>
<tr>
<td>user&#x2F;nouser</td>
<td align="center">是否允许此 filesystem 让任何使用者执行 mount ？一般来说，mount 只有 root 可以运行，但下达 user 参数，则可以让一般user也能够对此partition进行mount</td>
</tr>
<tr>
<td>suid&#x2F;nosuid</td>
<td align="center">是否允许此 filesystem 含有 suid&#x2F;sgid 的文件格式</td>
</tr>
<tr>
<td>defaults</td>
<td align="center">默认值为：rw, suid, dev, exec, auto, nouser, async，使用defaults即可</td>
</tr>
</tbody></table>
<p>第五栏:能否被dump备份命令 一般输入0即可<br>第六栏:能否以fsck检查磁区<br>早起开机流程回去检查本机文件系统是否clean,xfs没有办法使用，因为xfs会自己进行检查、不需要额外动作，所以直接填0<br>UUID&#x3D;f50beef2-2ee9-4400-9027-2ebf71c90e00 &#x2F;data&#x2F;xfs               xfs     defaults        0 0</p>
<p>&#x2F;etc&#x2F;fstab是开机时的设置文件,实际filesystem的挂载到&#x2F;etc&#x2F;mtab与&#x2F;proc&#x2F;mounts中的.<br>在单人维护模式中,&#x2F;是只读的,无法修改&#x2F;etc&#x2F;fstab，可以这样做</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -<span class="built_in">n</span> -o remount,rw /</span><br></pre></td></tr></table></figure>

<h3 id="特殊装置loop挂载-不烧录就挂载使用"><a href="#特殊装置loop挂载-不烧录就挂载使用" class="headerlink" title="特殊装置loop挂载(不烧录就挂载使用)"></a>特殊装置loop挂载(不烧录就挂载使用)</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#挂载DVD镜像</span><br><span class="line">[root@study ~]#ll -h <span class="regexp">/tmp/</span>CentOS-<span class="number">7.0</span>-<span class="number">1406</span>-x86_64-DVD.iso</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">3.9</span>G Jul  <span class="number">7</span>  <span class="number">2014</span> <span class="regexp">/tmp/</span>CentOS-<span class="number">7.0</span>-<span class="number">1406</span>-x86_64-DVD.iso</span><br><span class="line">[root@study ~]# mkdir <span class="regexp">/data/</span>centos_dvd</span><br><span class="line">[root@study ~]# mount -o loop <span class="regexp">/tmp/</span>CentOS-<span class="number">7.0</span>-<span class="number">1406</span>-x86_64-DVD.iso <span class="regexp">/data/</span>centos_dvd</span><br><span class="line">[root@study ~]# df <span class="regexp">/data/</span>centos_dvd</span><br><span class="line">Filesystem     <span class="number">1</span>K-blocks    Used Available Use% Mounted on</span><br><span class="line"><span class="regexp">/dev/</span>loop0       <span class="number">4050860</span> <span class="number">4050860</span>         <span class="number">0</span> <span class="number">100</span>% <span class="regexp">/data/</span>centos_dvd</span><br><span class="line"># 就是这个项目！ .iso 镜像内的文件可以在 <span class="regexp">/data/</span>centos_dvd 看到！</span><br><span class="line"></span><br><span class="line">[root@study ~]# ll <span class="regexp">/data/</span>centos_dvd</span><br><span class="line">total <span class="number">607</span></span><br><span class="line">-rw-r--r--. <span class="number">1</span>  <span class="number">500</span>  <span class="number">502</span>     <span class="number">14</span> Jul  <span class="number">5</span>  <span class="number">2014</span> CentOS_BuildTag</span><br><span class="line">drwxr-xr-x. <span class="number">3</span>  <span class="number">500</span>  <span class="number">502</span>   <span class="number">2048</span> Jul  <span class="number">4</span>  <span class="number">2014</span> EFI</span><br><span class="line">-rw-r--r--. <span class="number">1</span>  <span class="number">500</span>  <span class="number">502</span>    <span class="number">611</span> Jul  <span class="number">5</span>  <span class="number">2014</span> EULA</span><br><span class="line">-rw-r--r--. <span class="number">1</span>  <span class="number">500</span>  <span class="number">502</span>  <span class="number">18009</span> Jul  <span class="number">5</span>  <span class="number">2014</span> GPL</span><br><span class="line">drwxr-xr-x. <span class="number">3</span>  <span class="number">500</span>  <span class="number">502</span>   <span class="number">2048</span> Jul  <span class="number">4</span>  <span class="number">2014</span> images</span><br><span class="line">.....(底下省略).....</span><br><span class="line"></span><br><span class="line">[root@study ~]# umount <span class="regexp">/data/</span>centos_dvd/</span><br></pre></td></tr></table></figure>
<p>挂载大文件制作loop设备文件</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.建立大型文件</span></span><br><span class="line"><span class="comment">#if input file，输入档案，那个/dev/zero是会一直输出0的装置</span></span><br><span class="line"><span class="comment">#of output file 将一堆0写入到后面的文件中</span></span><br><span class="line"><span class="comment">#bs 每个block大小,就像文件系统的block一样</span></span><br><span class="line"><span class="comment">#count 总共多少个bs</span></span><br><span class="line"><span class="comment">#容量=bs*count</span></span><br><span class="line">[root@CentOS7 ~]# dd <span class="attribute">if</span>=/dev/zero <span class="attribute">of</span>=/srv/loopdev <span class="attribute">bs</span>=1M <span class="attribute">count</span>=512</span><br><span class="line">记录了512+0 的读入</span><br><span class="line">记录了512+0 的写出</span><br><span class="line">536870912字节(537 MB)已复制，0.625602 秒，858 MB/秒</span><br><span class="line">[root@CentOS7 ~]# ll -h /srv/loopdev </span><br><span class="line">-rw-r--r--. 1 root root 512M 3月   7 14:15 /srv/loopdev</span><br><span class="line"><span class="comment">#2.强制格式化</span></span><br><span class="line">[root@CentOS7 ~]# mkfs.xfs -f /srv/loopdev </span><br><span class="line"><span class="attribute">meta-data</span>=/srv/loopdev           <span class="attribute">isize</span>=512    <span class="attribute">agcount</span>=4, <span class="attribute">agsize</span>=32768 blks</span><br><span class="line">         =                       <span class="attribute">sectsz</span>=512   <span class="attribute">attr</span>=2, <span class="attribute">projid32bit</span>=1</span><br><span class="line">         =                       <span class="attribute">crc</span>=1        <span class="attribute">finobt</span>=0, <span class="attribute">sparse</span>=0</span><br><span class="line">data     =                       <span class="attribute">bsize</span>=4096   <span class="attribute">blocks</span>=131072, <span class="attribute">imaxpct</span>=25</span><br><span class="line">         =                       <span class="attribute">sunit</span>=0      <span class="attribute">swidth</span>=0 blks</span><br><span class="line">naming   =version 2              <span class="attribute">bsize</span>=4096   <span class="attribute">ascii-ci</span>=0 <span class="attribute">ftype</span>=1</span><br><span class="line">log      =internal log           <span class="attribute">bsize</span>=4096   <span class="attribute">blocks</span>=855, <span class="attribute">version</span>=2</span><br><span class="line">         =                       <span class="attribute">sectsz</span>=512   <span class="attribute">sunit</span>=0 blks, <span class="attribute">lazy-count</span>=1</span><br><span class="line">realtime =none                   <span class="attribute">extsz</span>=4096   <span class="attribute">blocks</span>=0, <span class="attribute">rtextents</span>=0</span><br><span class="line">[root@CentOS7 ~]# blkid /srv/loopdev</span><br><span class="line"><span class="comment">#3.挂载</span></span><br><span class="line">/srv/loopdev: <span class="attribute">UUID</span>=<span class="string">&quot;64954393-f98f-4ce8-bc6f-e78302d860a2&quot;</span> <span class="attribute">TYPE</span>=<span class="string">&quot;xfs&quot;</span> </span><br><span class="line">[root@CentOS7 ~]# mount -o loop <span class="attribute">UUID</span>=<span class="string">&quot;64954393-f98f-4ce8-bc6f-e78302d860a2&quot;</span> /mnt</span><br><span class="line">[root@CentOS7 ~]# df /mnt/</span><br><span class="line">文件系统        1K-块  已用   可用 已用% 挂载点</span><br><span class="line">/dev/loop0     520868 26388 494480    6% /mnt</span><br><span class="line"><span class="comment">#4.设置开机挂载</span></span><br><span class="line">[root@CentOS7 ~]# vim /etc/fstab</span><br><span class="line"><span class="comment">#添加一行/srv/loopdev  /data/file  xfs  defaults,loop   0 0</span></span><br><span class="line">[root@CentOS7 ~]# umount /mnt</span><br><span class="line">[root@CentOS7 ~]# mkdir /data/file</span><br><span class="line">[root@CentOS7 ~]# mount -a</span><br><span class="line">[root@CentOS7 ~]# df /data/file/</span><br><span class="line">文件系统        1K-块  已用   可用 已用% 挂载点</span><br><span class="line">/dev/loop0     520868 26388 494480    6% /data/file</span><br></pre></td></tr></table></figure>

<h2 id="swap建立"><a href="#swap建立" class="headerlink" title="swap建立"></a>swap建立</h2><h3 id="使用实体分割槽建置swap"><a href="#使用实体分割槽建置swap" class="headerlink" title="使用实体分割槽建置swap"></a>使用实体分割槽建置swap</h3><ol>
<li>分割:先使用gdisk在硬盘上分割出一个分割槽给系统作为swap,别忘了设置system ID</li>
<li>格式化:利用建立swap格式的[mkswap 设备名] 就能够格式化分割槽为swap格式</li>
<li>使用:最后将该swap装置启动，方法为 [swapon 设备名]</li>
<li>观察:最终通过free与swapon -s 命令来观察内存的用量</li>
</ol>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.先进行分割行为</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># gdisk /dev/sda</span></span><br><span class="line">...省略</span><br><span class="line">[root@CentOS7 ~]<span class="comment"># partprobe</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># lsblk</span></span><br><span class="line">NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sda               <span class="number">8</span>:<span class="number">0</span>    <span class="number">0</span>  <span class="number">200</span>G  <span class="number">0</span> disk</span><br><span class="line">├─sda1            <span class="number">8</span>:<span class="number">1</span>    <span class="number">0</span>    <span class="number">2</span>M  <span class="number">0</span> part</span><br><span class="line">├─sda2            <span class="number">8</span>:<span class="number">2</span>    <span class="number">0</span>    <span class="number">1</span>G  <span class="number">0</span> part /boot</span><br><span class="line">├─sda3            <span class="number">8</span>:<span class="number">3</span>    <span class="number">0</span>  <span class="number">150</span>G  <span class="number">0</span> part</span><br><span class="line">│ ├─centos-root <span class="number">253</span>:<span class="number">0</span>    <span class="number">0</span>  <span class="number">100</span>G  <span class="number">0</span> lvm  /</span><br><span class="line">│ ├─centos-swap <span class="number">253</span>:<span class="number">1</span>    <span class="number">0</span>    <span class="number">4</span>G  <span class="number">0</span> lvm  [SWAP]</span><br><span class="line">│ └─centos-home <span class="number">253</span>:<span class="number">2</span>    <span class="number">0</span>   <span class="number">20</span>G  <span class="number">0</span> lvm  /home</span><br><span class="line">├─sda4            <span class="number">8</span>:<span class="number">4</span>    <span class="number">0</span>    <span class="number">1</span>G  <span class="number">0</span> part <span class="regexp">/data/</span>xfs</span><br><span class="line">├─sda5            <span class="number">8</span>:<span class="number">5</span>    <span class="number">0</span>    <span class="number">1</span>G  <span class="number">0</span> part</span><br><span class="line">└─sda6            <span class="number">8</span>:<span class="number">6</span>    <span class="number">0</span>  <span class="number">512</span>M  <span class="number">0</span> part</span><br><span class="line">sr0              <span class="number">11</span>:<span class="number">0</span>    <span class="number">1</span>  <span class="number">7.7</span>G  <span class="number">0</span> rom  <span class="regexp">/run/m</span>edia<span class="regexp">/haokaiyang/</span>CentOS <span class="number">7</span> x86_64</span><br><span class="line">loop0             <span class="number">7</span>:<span class="number">0</span>    <span class="number">0</span>  <span class="number">512</span>M  <span class="number">0</span> loop <span class="regexp">/data/</span>file</span><br><span class="line"><span class="comment">#2.设置swap格式</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># mkswap /dev/sda6</span></span><br><span class="line">正在设置交换空间版本 <span class="number">1</span>，大小 = <span class="number">524284</span> KiB</span><br><span class="line">无标签，UUID=<span class="number">272932</span>b8-b348-<span class="number">447</span>c-ac76-<span class="number">3</span>b1f1d5bd326</span><br><span class="line">[root@CentOS7 ~]<span class="comment"># blkid /dev/sda6</span></span><br><span class="line"><span class="regexp">/dev/</span>sda6: UUID=<span class="string">&quot;272932b8-b348-447c-ac76-3b1f1d5bd326&quot;</span> TYPE=<span class="string">&quot;swap&quot;</span> PARTLABEL=<span class="string">&quot;Linux swap&quot;</span> PARTUUID=<span class="string">&quot;55a219d6-d175-4e94-af8d-08c791807714&quot;</span> </span><br><span class="line"><span class="comment">#3.观察</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># free</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:        <span class="number">3832972</span>      <span class="number">527140</span>     <span class="number">2791900</span>       <span class="number">10656</span>      <span class="number">513932</span>     <span class="number">3037500</span></span><br><span class="line">Swap:       <span class="number">4194300</span>           <span class="number">0</span>     <span class="number">4194300</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># swapon /dev/sda6</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># free</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:        <span class="number">3832972</span>      <span class="number">524716</span>     <span class="number">2794348</span>       <span class="number">10656</span>      <span class="number">513908</span>     <span class="number">3039972</span></span><br><span class="line">Swap:       <span class="number">4718584</span>           <span class="number">0</span>     <span class="number">4718584</span></span><br><span class="line"><span class="comment">#看到增加了</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># swapon -s</span></span><br><span class="line">文件名       类型    大小  已用  权限</span><br><span class="line"><span class="regexp">/dev/</span>dm-<span class="number">1</span>                               partition <span class="number">4194300</span> <span class="number">0</span> -<span class="number">1</span></span><br><span class="line"><span class="regexp">/dev/</span>sda6                               partition <span class="number">524284</span>  <span class="number">0</span> -<span class="number">2</span></span><br><span class="line"><span class="comment">#4.加入自动挂载</span></span><br><span class="line">[root@CentOS7 ~]<span class="comment"># vim /etc/fstab</span></span><br><span class="line">加入以下</span><br><span class="line">UUID=<span class="number">272932</span>b8-b348-<span class="number">447</span>c-ac76-<span class="number">3</span>b1f1d5bd326 swap swap     defaults         <span class="number">0</span> <span class="number">0</span></span><br><span class="line">~</span><br></pre></td></tr></table></figure>

<h3 id="使用文件建置swap"><a href="#使用文件建置swap" class="headerlink" title="使用文件建置swap"></a>使用文件建置swap</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1</span>.建立个大文件</span><br><span class="line">[root@CentOS7 ~]# dd <span class="keyword">if</span>=<span class="regexp">/dev/</span>zero of=<span class="regexp">/tmp/</span>swap bs=<span class="number">1</span>M <span class="keyword">count</span>=<span class="number">128</span></span><br><span class="line">记录了<span class="number">128</span>+<span class="number">0</span> 的读入</span><br><span class="line">记录了<span class="number">128</span>+<span class="number">0</span> 的写出</span><br><span class="line"><span class="number">134217728</span>字节(<span class="number">134</span> MB)已复制，<span class="number">0.132875</span> 秒，<span class="number">1.0</span> GB/秒</span><br><span class="line">[root@CentOS7 ~]# ll -h <span class="regexp">/tmp/</span>swap</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">128</span>M <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">05</span> <span class="regexp">/tmp/</span>swap</span><br><span class="line">#<span class="number">2</span>.使用mkswap将<span class="regexp">/tmp/</span>swap文件格式化为swap格式的文件格式</span><br><span class="line">[root@CentOS7 ~]# mkswap <span class="regexp">/tmp/</span>swap</span><br><span class="line">正在设置交换空间版本 <span class="number">1</span>，大小 = <span class="number">131068</span> KiB</span><br><span class="line">无标签，UUID=<span class="number">347</span>dfea9-f34c-<span class="number">47</span>d1-b0d0-a03008a5dc31</span><br><span class="line">[root@CentOS7 ~]# swapon <span class="regexp">/tmp/</span>swap</span><br><span class="line">[root@CentOS7 ~]# swapon -s</span><br><span class="line">文件名       类型    大小  已用  权限</span><br><span class="line"><span class="regexp">/dev/</span>dm-<span class="number">1</span>                               partition <span class="number">4194300</span> <span class="number">0</span> -<span class="number">1</span></span><br><span class="line"><span class="regexp">/dev/</span>sda6                               partition <span class="number">524284</span>  <span class="number">0</span> -<span class="number">2</span></span><br><span class="line"><span class="regexp">/tmp/</span>swap                               <span class="keyword">file</span>  <span class="number">131068</span>  <span class="number">0</span> -<span class="number">3</span></span><br><span class="line">#关掉swap <span class="keyword">file</span> 并设置自动启用</span><br><span class="line">[root@CentOS7 ~]# vim <span class="regexp">/etc/</span>fstab</span><br><span class="line">加入以下</span><br><span class="line"><span class="regexp">/tmp/</span>swap                                 swap swap     defaults         <span class="number">0</span> <span class="number">0</span></span><br><span class="line">[root@CentOS7 ~]# swapoff <span class="regexp">/tmp/</span>swap <span class="regexp">/dev/</span>sda6</span><br><span class="line">[root@CentOS7 ~]# swapon -s</span><br><span class="line">文件名       类型    大小  已用  权限</span><br><span class="line"><span class="regexp">/dev/</span>dm-<span class="number">1</span>                               partition <span class="number">4194300</span> <span class="number">0</span> -<span class="number">1</span></span><br><span class="line">[root@CentOS7 ~]# swapon -a</span><br><span class="line">[root@CentOS7 ~]# swapon -s</span><br><span class="line">文件名       类型    大小  已用  权限</span><br><span class="line"><span class="regexp">/dev/</span>dm-<span class="number">1</span>                               partition <span class="number">4194300</span> <span class="number">0</span> -<span class="number">1</span></span><br><span class="line"><span class="regexp">/dev/</span>sda6                               partition <span class="number">524284</span>  <span class="number">0</span> -<span class="number">2</span></span><br><span class="line"><span class="regexp">/tmp/</span>swap                               <span class="keyword">file</span>  <span class="number">131068</span>  <span class="number">0</span> -<span class="number">3</span></span><br></pre></td></tr></table></figure>

<h2 id="文件系统的特殊观察与操作"><a href="#文件系统的特殊观察与操作" class="headerlink" title="文件系统的特殊观察与操作"></a>文件系统的特殊观察与操作</h2><h3 id="硬盘空间的浪费问题"><a href="#硬盘空间的浪费问题" class="headerlink" title="硬盘空间的浪费问题"></a>硬盘空间的浪费问题</h3><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@CentOS7 ~]<span class="comment"># ll -sh</span></span><br><span class="line">总用量 12K</span><br><span class="line">4.0K -rw-------.<span class="number"> 1 </span>root root 2.1K 2月  27 18:06 anaconda-ks.cfg</span><br><span class="line">4.0K -rw-r--r--.<span class="number"> 2 </span>root root  451 6月  10<span class="number"> 2014 </span>crontab</span><br><span class="line">   0 lrwxrwxrwx.<span class="number"> 1 </span>root root  <span class="number"> 12 </span>3月  <span class="number"> 6 </span>16:40 crontab2 -&gt; /etc/crontab</span><br><span class="line">4.0K -rw-r--r--.<span class="number"> 1 </span>root root 2.2K 2月  27 18:07 initial-setup-ks.cfg</span><br></pre></td></tr></table></figure>
<p>总用量&#x3D;实际block数量*block大小<br>那个crontab虽然451bytes，但是占用了整个block</p>
<h3 id="利用GNU的parted进行分割行为"><a href="#利用GNU的parted进行分割行为" class="headerlink" title="利用GNU的parted进行分割行为"></a>利用GNU的parted进行分割行为</h3><p>虽然gdisk和fdisk可以分别对GPT&#x2F;MBR进分割,我们还有一个同时支持的命令</p>
<pre><code>命令:parted 设备 [命令 [参数]]
命令功能:
    新增分割:mkpart [primary|logical|extended] [ext4|vfat|xfs] 开始 结束
    显示分割:print
    删除分割:rm [partition]
</code></pre>
<h4 id="查看本机分割表资料"><a href="#查看本机分割表资料" class="headerlink" title="查看本机分割表资料"></a>查看本机分割表资料</h4><p>[root@CentOS7 ~]# parted &#x2F;dev&#x2F;sda print<br>Model: ATA VBOX HARDDISK (scsi)<br>Disk &#x2F;dev&#x2F;sda: 215GB<br>Sector size (logical&#x2F;physical): 512B&#x2F;512B<br>Partition Table: gpt<br>Disk Flags: pmbr_boot</p>
<p>Number  Start   End     Size    File system     Name                  标志<br> 1      1049kB  3146kB  2097kB                                        bios_grub<br> 2      3146kB  1077MB  1074MB  xfs<br> 3      1077MB  162GB   161GB                                         lvm<br> 4      162GB   163GB   1074MB  xfs             Linux filesystem<br> 5      163GB   164GB   1074MB  ext4            Microsoft basic data<br> 6      164GB   165GB   537MB   linux-swap(v1)  Linux swap<br>Number分割槽的号码 1就是&#x2F;dev&#x2F;sda1的意思<br>Start 分割的起始位置在这颗硬盘的多少MB处，以容量为单位<br>End 此分割的结束位置在这颗硬盘的多少MB处<br>Size  由以上两项得出分割槽的容量<br>File system 文件类型类型<br>Name 和gdisk的System ID一个意思</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">#固定单位显示</span><br><span class="line">[root@CentOS7 ~]# parted <span class="regexp">/dev/</span>sda unit mb <span class="keyword">print</span></span><br><span class="line">#将<span class="regexp">/dev/</span>sda原本的MBR变成GPT</span><br><span class="line">[root@CentOS7 ~]# parted <span class="regexp">/dev/</span>sda mklabel gpt</span><br><span class="line">#使用parted建立一个<span class="number">1000</span>M容量的分割槽</span><br><span class="line">[root@CentOS7 ~]# parted <span class="regexp">/dev/</span>sda unit mb <span class="keyword">print</span></span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)</span><br><span class="line">Disk <span class="regexp">/dev/</span>sda: <span class="number">214748</span>MB</span><br><span class="line">Sector <span class="keyword">size</span> (logical<span class="regexp">/physical): 512B/</span><span class="number">512</span>B</span><br><span class="line">Partition Table: gpt</span><br><span class="line">Disk Flags: pmbr_boot</span><br><span class="line"></span><br><span class="line">Number  Start     End       <span class="keyword">Size</span>      <span class="keyword">File</span> system     Name                  标志</span><br><span class="line"> <span class="number">1</span>      <span class="number">1.05</span>MB    <span class="number">3.15</span>MB    <span class="number">2.10</span>MB                                          bios_grub</span><br><span class="line"> <span class="number">2</span>      <span class="number">3.15</span>MB    <span class="number">1077</span>MB    <span class="number">1074</span>MB    xfs</span><br><span class="line"> <span class="number">3</span>      <span class="number">1077</span>MB    <span class="number">162142</span>MB  <span class="number">161065</span>MB                                        lvm</span><br><span class="line"> <span class="number">4</span>      <span class="number">162142</span>MB  <span class="number">163216</span>MB  <span class="number">1074</span>MB    xfs             Linux filesystem</span><br><span class="line"> <span class="number">5</span>      <span class="number">163216</span>MB  <span class="number">164290</span>MB  <span class="number">1074</span>MB    ext4            Microsoft basic data</span><br><span class="line"> <span class="number">6</span>      <span class="number">164290</span>MB  <span class="number">164827</span>MB  <span class="number">537</span>MB     linux-swap(v1)  Linux swap</span><br><span class="line"></span><br><span class="line">[root@CentOS7 ~]# parted <span class="regexp">/dev/</span>sda mkpart primary fat32 <span class="number">164827</span>MB <span class="number">165827</span>MB</span><br><span class="line">信息: You may need to update <span class="regexp">/etc/</span>fstab.</span><br><span class="line"></span><br><span class="line">[root@CentOS7 ~]# parted <span class="regexp">/dev/</span>sda <span class="keyword">print</span></span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)</span><br><span class="line">Disk <span class="regexp">/dev/</span>sda: <span class="number">215</span>GB</span><br><span class="line">Sector <span class="keyword">size</span> (logical<span class="regexp">/physical): 512B/</span><span class="number">512</span>B</span><br><span class="line">Partition Table: gpt</span><br><span class="line">Disk Flags: pmbr_boot</span><br><span class="line"></span><br><span class="line">Number  Start   End     <span class="keyword">Size</span>    <span class="keyword">File</span> system     Name                  标志</span><br><span class="line"> <span class="number">1</span>      <span class="number">1049</span>kB  <span class="number">3146</span>kB  <span class="number">2097</span>kB                                        bios_grub</span><br><span class="line"> <span class="number">2</span>      <span class="number">3146</span>kB  <span class="number">1077</span>MB  <span class="number">1074</span>MB  xfs</span><br><span class="line"> <span class="number">3</span>      <span class="number">1077</span>MB  <span class="number">162</span>GB   <span class="number">161</span>GB                                         lvm</span><br><span class="line"> <span class="number">4</span>      <span class="number">162</span>GB   <span class="number">163</span>GB   <span class="number">1074</span>MB  xfs             Linux filesystem</span><br><span class="line"> <span class="number">5</span>      <span class="number">163</span>GB   <span class="number">164</span>GB   <span class="number">1074</span>MB  ext4            Microsoft basic data</span><br><span class="line"> <span class="number">6</span>      <span class="number">164</span>GB   <span class="number">165</span>GB   <span class="number">537</span>MB   linux-swap(v1)  Linux swap</span><br><span class="line"> <span class="number">7</span>      <span class="number">165</span>GB   <span class="number">166</span>GB   <span class="number">1000</span>MB                  primary</span><br><span class="line"></span><br><span class="line">[root@CentOS7 ~]# partprobe</span><br><span class="line">[root@CentOS7 ~]# lsblk <span class="regexp">/dev/</span>sda</span><br><span class="line"><span class="regexp">/dev/</span>sda   <span class="regexp">/dev/</span>sda2  <span class="regexp">/dev/</span>sda4  <span class="regexp">/dev/</span>sda6  </span><br><span class="line"><span class="regexp">/dev/</span>sda1  <span class="regexp">/dev/</span>sda3  <span class="regexp">/dev/</span>sda5  <span class="regexp">/dev/</span>sda7  </span><br><span class="line">[root@CentOS7 ~]# lsblk <span class="regexp">/dev/</span>sda7</span><br><span class="line">NAME MAJ:MIN RM  <span class="keyword">SIZE</span> RO TYPE MOUNTPOINT</span><br><span class="line">sda7   <span class="number">8</span>:<span class="number">7</span>    <span class="number">0</span>  <span class="number">954</span>M  <span class="number">0</span> part</span><br><span class="line">[root@CentOS7 ~]# mkfs -t vfat <span class="regexp">/dev/</span>sda7</span><br><span class="line">mkfs.fat <span class="number">3.0</span>.<span class="number">20</span> (<span class="number">12</span> Jun <span class="number">2013</span>)</span><br><span class="line">[root@CentOS7 ~]# blkid <span class="regexp">/dev/</span>sda7</span><br><span class="line"><span class="regexp">/dev/</span>sda7: UUID=<span class="string">&quot;1AB8-6570&quot;</span> TYPE=<span class="string">&quot;vfat&quot;</span> PARTLABEL=<span class="string">&quot;primary&quot;</span> PARTUUID=<span class="string">&quot;0cff3593-365f-4495-9a9a-b7e37c019ebf&quot;</span> </span><br><span class="line">[root@CentOS7 ~]# vim <span class="regexp">/etc/</span>fstab</span><br><span class="line">UUID=<span class="number">1</span>AB8-<span class="number">6570</span>                           <span class="regexp">/data/</span>win                vfat   defaults         <span class="number">0</span> <span class="number">0</span></span><br><span class="line">[root@CentOS7 ~]# mkdir <span class="regexp">/data/</span>win</span><br><span class="line">[root@CentOS7 ~]# mount -a</span><br><span class="line">[root@CentOS7 ~]# df <span class="regexp">/data/</span>win</span><br><span class="line">文件系统        <span class="number">1</span>K-块  已用   可用 已用% 挂载点</span><br><span class="line"><span class="regexp">/dev/</span>sda7      <span class="number">974972</span>     <span class="number">4</span> <span class="number">974968</span>    <span class="number">1</span>% <span class="regexp">/data/</span>win</span><br></pre></td></tr></table></figure>

<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">#卸载本章建立的所有分割槽</span><br><span class="line">[root@CentOS7 ~]# umount <span class="regexp">/data/</span>ext4<span class="regexp">/ /</span>data<span class="regexp">/xfs /</span>data<span class="regexp">/file/</span> <span class="regexp">/data/</span>win/</span><br><span class="line">[root@CentOS7 ~]# swapoff <span class="regexp">/dev/</span>s</span><br><span class="line">sda       sda3      sda6      sg1       snd/      stdin     </span><br><span class="line">sda1      sda4      sda7      shm/      sr0       stdout    </span><br><span class="line">sda2      sda5      sg0       snapshot  stderr    </span><br><span class="line">[root@CentOS7 ~]# swapoff <span class="regexp">/dev/</span>sda6 <span class="regexp">/tmp/</span>swap</span><br><span class="line">[root@CentOS7 ~]# umount <span class="regexp">/data/</span>ext4<span class="regexp">/ /</span>data<span class="regexp">/xfs /</span>data<span class="regexp">/file/</span> <span class="regexp">/data/</span>win/</span><br><span class="line">umount: <span class="regexp">/data/</span>ext4/：未挂载</span><br><span class="line">[root@CentOS7 ~]# swapoff <span class="regexp">/dev/</span>s</span><br><span class="line">sda       sda3      sda6      sg1       snd/      stdin     </span><br><span class="line">sda1      sda4      sda7      shm/      sr0       stdout    </span><br><span class="line">sda2      sda5      sg0       snapshot  stderr    </span><br><span class="line">[root@CentOS7 ~]# swapoff <span class="regexp">/dev/</span>sda6 <span class="regexp">/tmp/</span>swap</span><br><span class="line">[root@CentOS7 ~]# vim <span class="regexp">/etc/</span>fstab </span><br><span class="line">[root@CentOS7 ~]# parted <span class="regexp">/dev/</span>sda</span><br><span class="line">sda   sda1  sda2  sda3  sda4  sda5  sda6  sda7  </span><br><span class="line">[root@CentOS7 ~]# parted <span class="regexp">/dev/</span>sda rm <span class="number">7</span></span><br><span class="line">^[[A信息: You may need to update <span class="regexp">/etc/</span>fstab.</span><br><span class="line"></span><br><span class="line">[root@CentOS7 ~]# parted <span class="regexp">/dev/</span>sda rm <span class="number">6</span></span><br><span class="line">信息: You may need to update <span class="regexp">/etc/</span>fstab.</span><br><span class="line"></span><br><span class="line">[root@CentOS7 ~]# parted <span class="regexp">/dev/</span>sda rm <span class="number">5</span></span><br><span class="line">信息: You may need to update <span class="regexp">/etc/</span>fstab.</span><br><span class="line"></span><br><span class="line">[root@CentOS7 ~]# parted <span class="regexp">/dev/</span>sda rm <span class="number">4</span></span><br><span class="line">错误: Partition <span class="regexp">/dev/</span>sda4 is being used. You must unmount it before you modify it</span><br><span class="line">with Parted.</span><br><span class="line">[root@CentOS7 ~]# partprobe</span><br><span class="line">Warning: 无法以读写方式打开 <span class="regexp">/dev/</span>sr0 (只读文件系统)。<span class="regexp">/dev/</span>sr0 已按照只读方式打开。</span><br><span class="line">[root@CentOS7 ~]# rm -rf <span class="regexp">/tmp/</span>swap <span class="regexp">/srv/</span>loopdev </span><br><span class="line">[root@CentOS7 ~]# ls -ls <span class="regexp">/dev/</span>sda*</span><br><span class="line"><span class="number">0</span> brw-rw----. <span class="number">1</span> root disk <span class="number">8</span>, <span class="number">0</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">50</span> <span class="regexp">/dev/</span>sda</span><br><span class="line"><span class="number">0</span> brw-rw----. <span class="number">1</span> root disk <span class="number">8</span>, <span class="number">1</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">50</span> <span class="regexp">/dev/</span>sda1</span><br><span class="line"><span class="number">0</span> brw-rw----. <span class="number">1</span> root disk <span class="number">8</span>, <span class="number">2</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">50</span> <span class="regexp">/dev/</span>sda2</span><br><span class="line"><span class="number">0</span> brw-rw----. <span class="number">1</span> root disk <span class="number">8</span>, <span class="number">3</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">50</span> <span class="regexp">/dev/</span>sda3</span><br><span class="line"><span class="number">0</span> brw-rw----. <span class="number">1</span> root disk <span class="number">8</span>, <span class="number">4</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">50</span> <span class="regexp">/dev/</span>sda4</span><br><span class="line">[root@CentOS7 ~]# cd <span class="regexp">/data/</span></span><br><span class="line">[root@CentOS7 data]# ls -la</span><br><span class="line">总用量 <span class="number">0</span></span><br><span class="line">drwxr-xr-x.  <span class="number">9</span> root root  <span class="number">87</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">41</span> .</span><br><span class="line">dr-xr-xr-x. <span class="number">18</span> root root <span class="number">245</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">09</span>:<span class="number">42</span> ..</span><br><span class="line">drwxr-xr-x.  <span class="number">2</span> root root   <span class="number">6</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">09</span>:<span class="number">47</span> cdrom</span><br><span class="line">drwxr-xr-x.  <span class="number">2</span> root root   <span class="number">6</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">09</span>:<span class="number">42</span> ext4</span><br><span class="line">drwxr-xr-x.  <span class="number">2</span> root root   <span class="number">6</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">14</span>:<span class="number">21</span> <span class="keyword">file</span></span><br><span class="line">drwxr-xr-x.  <span class="number">2</span> root root   <span class="number">6</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">09</span>:<span class="number">53</span> usb</span><br><span class="line">drwxr-xr-x.  <span class="number">2</span> root root   <span class="number">6</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">10</span>:<span class="number">03</span> var</span><br><span class="line">drwxr-xr-x.  <span class="number">2</span> root root   <span class="number">6</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">41</span> win</span><br><span class="line">drwxr-xr-x.  <span class="number">2</span> root root   <span class="number">6</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">09</span>:<span class="number">15</span> xfs</span><br><span class="line">[root@CentOS7 data]# cd ext4/</span><br><span class="line">[root@CentOS7 ext4]# ls</span><br><span class="line">[root@CentOS7 ext4]# cd ..</span><br><span class="line">[root@CentOS7 data]# df</span><br><span class="line">文件系统                    <span class="number">1</span>K-块    已用      可用 已用% 挂载点</span><br><span class="line"><span class="regexp">/dev/m</span>apper<span class="regexp">/centos-root 104806400 4451884 100354516    5% /</span></span><br><span class="line">devtmpfs                  <span class="number">1900852</span>       <span class="number">0</span>   <span class="number">1900852</span>    <span class="number">0</span>% /dev</span><br><span class="line">tmpfs                     <span class="number">1916484</span>     <span class="number">156</span>   <span class="number">1916328</span>    <span class="number">1</span>% <span class="regexp">/dev/</span>shm</span><br><span class="line">tmpfs                     <span class="number">1916484</span>    <span class="number">8924</span>   <span class="number">1907560</span>    <span class="number">1</span>% /run</span><br><span class="line">tmpfs                     <span class="number">1916484</span>       <span class="number">0</span>   <span class="number">1916484</span>    <span class="number">0</span>% <span class="regexp">/sys/</span>fs/cgroup</span><br><span class="line"><span class="regexp">/dev/</span>sda2                 <span class="number">1038336</span>  <span class="number">175704</span>    <span class="number">862632</span>   <span class="number">17</span>% /boot</span><br><span class="line"><span class="regexp">/dev/m</span>apper<span class="regexp">/centos-home  20961280   37884  20923396    1% /</span>home</span><br><span class="line">tmpfs                      <span class="number">383300</span>      <span class="number">12</span>    <span class="number">383288</span>    <span class="number">1</span>% <span class="regexp">/run/u</span>ser/<span class="number">1000</span></span><br><span class="line"><span class="regexp">/dev/</span>sr0                  <span class="number">8086368</span> <span class="number">8086368</span>         <span class="number">0</span>  <span class="number">100</span>% <span class="regexp">/run/m</span>edia<span class="regexp">/haokaiyang/</span>CentOS <span class="number">7</span> x86_64</span><br><span class="line"><span class="regexp">/dev/</span>sda4                 <span class="number">1038336</span>   <span class="number">32880</span>   <span class="number">1005456</span>    <span class="number">4</span>% <span class="regexp">/data/</span>xfs</span><br><span class="line">[root@CentOS7 data]# parted <span class="regexp">/dev/</span>sda rm <span class="number">4</span></span><br><span class="line">错误: Partition <span class="regexp">/dev/</span>sda4 is being used. You must unmount it before you modify it</span><br><span class="line">with Parted.</span><br><span class="line">[root@CentOS7 data]# cd ..                                                </span><br><span class="line">[root@CentOS7 <span class="regexp">/]# parted /</span>dev/sda rm <span class="number">4</span></span><br><span class="line">错误: Partition <span class="regexp">/dev/</span>sda4 is being used. You must unmount it before you modify it</span><br><span class="line">with Parted.</span><br><span class="line">[root@CentOS7 <span class="regexp">/]# umount /</span>dev/sda4</span><br><span class="line">[root@CentOS7 <span class="regexp">/]# parted /</span>dev/sda rm <span class="number">4</span></span><br><span class="line">信息: You may need to update <span class="regexp">/etc/</span>fstab.</span><br><span class="line"></span><br><span class="line">[root@CentOS7 <span class="regexp">/]# ls -ls /</span>dev/sda*</span><br><span class="line"><span class="number">0</span> brw-rw----. <span class="number">1</span> root disk <span class="number">8</span>, <span class="number">0</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">52</span> <span class="regexp">/dev/</span>sda</span><br><span class="line"><span class="number">0</span> brw-rw----. <span class="number">1</span> root disk <span class="number">8</span>, <span class="number">1</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">52</span> <span class="regexp">/dev/</span>sda1</span><br><span class="line"><span class="number">0</span> brw-rw----. <span class="number">1</span> root disk <span class="number">8</span>, <span class="number">2</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">52</span> <span class="regexp">/dev/</span>sda2</span><br><span class="line"><span class="number">0</span> brw-rw----. <span class="number">1</span> root disk <span class="number">8</span>, <span class="number">3</span> <span class="number">3</span>月   <span class="number">7</span> <span class="number">16</span>:<span class="number">52</span> <span class="regexp">/dev/</span>sda3</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Linux/" rel="tag"># Linux</a>
              <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag"># 学习笔记</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2017/03/01/centos7-learning-notes-2/" rel="prev" title="《鸟哥的Linux私房菜》文件与目录管理学习笔记">
                  <i class="fa fa-chevron-left"></i> 《鸟哥的Linux私房菜》文件与目录管理学习笔记
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2017/03/08/centos7-learning-notes-4/" rel="next" title="《鸟哥的Linux私房菜》文件与文件系统的压缩、打包与备份学习笔记">
                  《鸟哥的Linux私房菜》文件与文件系统的压缩、打包与备份学习笔记 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2014 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">郝凯阳</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">146k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">2:12</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>



  <script src="/js/third-party/fancybox.js"></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"haokaiyang/haokaiyang.github.io","issue_term":"og:title","theme":"github-light"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
